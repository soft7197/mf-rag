{
    "JxPath-1": {
        "function_num": 2,
        "functions": [
            {
                "path": "src/java/org/apache/commons/jxpath/ri/model/dom/DOMNodePointer.java",
                "start_loc": 87,
                "end_loc": 135,
                "buggy_function": "    public static boolean testNode(Node node, NodeTest test) {\n        if (test == null) {\n            return true;\n        }\n        else if (test instanceof NodeNameTest) {\n            if (node.getNodeType() != Node.ELEMENT_NODE) {\n                return false;\n            }\n\n            NodeNameTest nodeNameTest = (NodeNameTest) test;\n            QName testName = nodeNameTest.getNodeName();\n            String namespaceURI = nodeNameTest.getNamespaceURI();\n            boolean wildcard = nodeNameTest.isWildcard();\n            String testPrefix = testName.getPrefix();\n            if (wildcard && testPrefix == null) {\n                return true;\n            }\n\n            if (wildcard\n                || testName.getName()\n                        .equals(DOMNodePointer.getLocalName(node))) {\n                String nodeNS = DOMNodePointer.getNamespaceURI(node);\n                return equalStrings(namespaceURI, nodeNS);\n            }\n        }\n        else if (test instanceof NodeTypeTest) {\n            int nodeType = node.getNodeType();\n            switch (((NodeTypeTest) test).getNodeType()) {\n                case Compiler.NODE_TYPE_NODE :\n                    return nodeType == Node.ELEMENT_NODE;\n                case Compiler.NODE_TYPE_TEXT :\n                    return nodeType == Node.CDATA_SECTION_NODE\n                        || nodeType == Node.TEXT_NODE;\n                case Compiler.NODE_TYPE_COMMENT :\n                    return nodeType == Node.COMMENT_NODE;\n                case Compiler.NODE_TYPE_PI :\n                    return nodeType == Node.PROCESSING_INSTRUCTION_NODE;\n            }\n            return false;\n        }\n        else if (test instanceof ProcessingInstructionTest) {\n            if (node.getNodeType() == Node.PROCESSING_INSTRUCTION_NODE) {\n                String testPI = ((ProcessingInstructionTest) test).getTarget();\n                String nodePI = ((ProcessingInstruction) node).getTarget();\n                return testPI.equals(nodePI);\n            }\n        }\n        return false;\n    }\n",
                "fixed_function": "    public static boolean testNode(Node node, NodeTest test) {\n        if (test == null) {\n            return true;\n        }\n        else if (test instanceof NodeNameTest) {\n            if (node.getNodeType() != Node.ELEMENT_NODE) {\n                return false;\n            }\n\n            NodeNameTest nodeNameTest = (NodeNameTest) test;\n            QName testName = nodeNameTest.getNodeName();\n            String namespaceURI = nodeNameTest.getNamespaceURI();\n            boolean wildcard = nodeNameTest.isWildcard();\n            String testPrefix = testName.getPrefix();\n            if (wildcard && testPrefix == null) {\n                return true;\n            }\n\n            if (wildcard\n                || testName.getName()\n                        .equals(DOMNodePointer.getLocalName(node))) {\n                String nodeNS = DOMNodePointer.getNamespaceURI(node);\n                return equalStrings(namespaceURI, nodeNS);\n            }\n        }\n        else if (test instanceof NodeTypeTest) {\n            int nodeType = node.getNodeType();\n            switch (((NodeTypeTest) test).getNodeType()) {\n                case Compiler.NODE_TYPE_NODE :\n                    return nodeType == Node.ELEMENT_NODE\n                            || nodeType == Node.DOCUMENT_NODE;\n                case Compiler.NODE_TYPE_TEXT :\n                    return nodeType == Node.CDATA_SECTION_NODE\n                        || nodeType == Node.TEXT_NODE;\n                case Compiler.NODE_TYPE_COMMENT :\n                    return nodeType == Node.COMMENT_NODE;\n                case Compiler.NODE_TYPE_PI :\n                    return nodeType == Node.PROCESSING_INSTRUCTION_NODE;\n            }\n            return false;\n        }\n        else if (test instanceof ProcessingInstructionTest) {\n            if (node.getNodeType() == Node.PROCESSING_INSTRUCTION_NODE) {\n                String testPI = ((ProcessingInstructionTest) test).getTarget();\n                String nodePI = ((ProcessingInstruction) node).getTarget();\n                return testPI.equals(nodePI);\n            }\n        }\n        return false;\n    }\n",
                "comment": "",
                "normalized_body": [
                    "public static boolean testNode(Node node, NodeTest test) { if (test == null) { return true; } else if (test instanceof NodeNameTest) { if (node.getNodeType() != Node.ELEMENT_NODE) { return false; } NodeNameTest nodeNameTest = (NodeNameTest) test; QName testName = nodeNameTest.getNodeName(); String namespaceURI = nodeNameTest.getNamespaceURI(); boolean wildcard = nodeNameTest.isWildcard(); String testPrefix = testName.getPrefix(); if (wildcard && testPrefix == null) { return true; } if (wildcard || testName.getName().equals(DOMNodePointer.getLocalName(node))) { String nodeNS = DOMNodePointer.getNamespaceURI(node); return equalStrings(namespaceURI, nodeNS); } } else if (test instanceof NodeTypeTest) { int nodeType = node.getNodeType(); switch(((NodeTypeTest) test).getNodeType()) { case Compiler.NODE_TYPE_NODE: return nodeType == Node.ELEMENT_NODE; case Compiler.NODE_TYPE_TEXT: return nodeType == Node.CDATA_SECTION_NODE || nodeType == Node.TEXT_NODE; case Compiler.NODE_TYPE_COMMENT: return nodeType == Node.COMMENT_NODE; case Compiler.NODE_TYPE_PI: return nodeType == Node.PROCESSING_INSTRUCTION_NODE; } return false; } else if (test instanceof ProcessingInstructionTest) { if (node.getNodeType() == Node.PROCESSING_INSTRUCTION_NODE) { String testPI = ((ProcessingInstructionTest) test).getTarget(); String nodePI = ((ProcessingInstruction) node).getTarget(); return testPI.equals(nodePI); } } return false; }"
                ],
                "top_similar_methods": [
                    [
                        0.9999999403953552,
                        "public static boolean testNode(Node node, NodeTest test) { if (test == null) { return true; } else if (test instanceof NodeNameTest) { if (node.getNodeType() != Node.ELEMENT_NODE) { return false; } NodeNameTest nodeNameTest = (NodeNameTest) test; QName testName = nodeNameTest.getNodeName(); String namespaceURI = nodeNameTest.getNamespaceURI(); boolean wildcard = nodeNameTest.isWildcard(); String testPrefix = testName.getPrefix(); if (wildcard && testPrefix == null) { return true; } if (wildcard || testName.getName().equals(DOMNodePointer.getLocalName(node))) { String nodeNS = DOMNodePointer.getNamespaceURI(node); return equalStrings(namespaceURI, nodeNS); } } else if (test instanceof NodeTypeTest) { int nodeType = node.getNodeType(); switch(((NodeTypeTest) test).getNodeType()) { case Compiler.NODE_TYPE_NODE: return nodeType == Node.ELEMENT_NODE; case Compiler.NODE_TYPE_TEXT: return nodeType == Node.CDATA_SECTION_NODE || nodeType == Node.TEXT_NODE; case Compiler.NODE_TYPE_COMMENT: return nodeType == Node.COMMENT_NODE; case Compiler.NODE_TYPE_PI: return nodeType == Node.PROCESSING_INSTRUCTION_NODE; } return false; } else if (test instanceof ProcessingInstructionTest) { if (node.getNodeType() == Node.PROCESSING_INSTRUCTION_NODE) { String testPI = ((ProcessingInstructionTest) test).getTarget(); String nodePI = ((ProcessingInstruction) node).getTarget(); return testPI.equals(nodePI); } } return false; }"
                    ],
                    [
                        0.9878427982330322,
                        "public static boolean testNode(NodePointer pointer, Object node, NodeTest test) { if (test == null) { return true; } else if (test instanceof NodeNameTest) { if (!(node instanceof Element)) { return false; } NodeNameTest nodeNameTest = (NodeNameTest) test; QName testName = nodeNameTest.getNodeName(); String namespaceURI = nodeNameTest.getNamespaceURI(); boolean wildcard = nodeNameTest.isWildcard(); String testPrefix = testName.getPrefix(); if (wildcard && testPrefix == null) { return true; } if (wildcard || testName.getName().equals(JDOMNodePointer.getLocalName(node))) { String nodeNS = JDOMNodePointer.getNamespaceURI(node); return equalStrings(namespaceURI, nodeNS); } } else if (test instanceof NodeTypeTest) { switch(((NodeTypeTest) test).getNodeType()) { case Compiler.NODE_TYPE_NODE: return node instanceof Element; case Compiler.NODE_TYPE_TEXT: return (node instanceof Text) || (node instanceof CDATA); case Compiler.NODE_TYPE_COMMENT: return node instanceof Comment; case Compiler.NODE_TYPE_PI: return node instanceof ProcessingInstruction; } return false; } else if (test instanceof ProcessingInstructionTest) { if (node instanceof ProcessingInstruction) { String testPI = ((ProcessingInstructionTest) test).getTarget(); String nodePI = ((ProcessingInstruction) node).getTarget(); return testPI.equals(nodePI); } } return false; }"
                    ],
                    [
                        0.9869861006736755,
                        "private static NodePointer doPredicateName(EvalContext context, NodePointer parent, Step[] steps, int currentStep, Expression[] predicates, int currentPredicate) { Expression predicate = predicates[currentPredicate]; String key = keyFromPredicate(context, predicate); NodePointer child = valuePointer(parent); if (child instanceof PropertyOwnerPointer) { PropertyPointer pointer = ((PropertyOwnerPointer) child).getPropertyPointer(); pointer.setPropertyName(key); if (pointer.isActual()) { return doPredicate(context, pointer, steps, currentStep, predicates, currentPredicate + 1); } } else if (child.isCollection()) { NodePointer bestMatch = null; int bestQuality = 0; child = (NodePointer) child.clone(); int count = child.getLength(); for (int i = 0; i < count; i++) { child.setIndex(i); NodePointer valuePointer = valuePointer(child); NodePointer pointer; if ((valuePointer instanceof PropertyOwnerPointer) || valuePointer.isCollection()) { pointer = doPredicateName(context, valuePointer, steps, currentStep, predicates, currentPredicate); } else if (isNameAttributeEqual(valuePointer, key)) { pointer = doPredicate(context, valuePointer, steps, currentStep, predicates, currentPredicate + 1); } else { pointer = null; } if (pointer != null) { int quality = computeQuality(pointer); if (quality == PERFECT_MATCH) { return pointer; } if (quality > bestQuality) { bestMatch = (NodePointer) pointer.clone(); bestQuality = quality; } } } if (bestMatch != null) { return bestMatch; } } else { NodePointer found = doPredicatesStandard(context, Collections.singletonList(child), steps, currentStep, predicates, currentPredicate); if (found != null) { return found; } } return createNullPointerForPredicates(context, child, steps, currentStep, predicates, currentPredicate); }"
                    ],
                    [
                        0.984514594078064,
                        "public Object convert(Object object, Class toType) { if (object == null) { if (toType.isPrimitive()) { return convertNullToPrimitive(toType); } return null; } if (toType == Object.class) { if (object instanceof NodeSet) { return convert(((NodeSet) object).getValues(), toType); } else if (object instanceof Pointer) { return convert(((Pointer) object).getValue(), toType); } return object; } Class fromType = object.getClass(); if (fromType.equals(toType) || toType.isAssignableFrom(fromType)) { return object; } if (fromType.isArray()) { int length = Array.getLength(object); if (toType.isArray()) { Class cType = toType.getComponentType(); Object array = Array.newInstance(cType, length); for (int i = 0; i < length; i++) { Object value = Array.get(object, i); Array.set(array, i, convert(value, cType)); } return array; } else if (Collection.class.isAssignableFrom(toType)) { Collection collection = allocateCollection(toType); for (int i = 0; i < length; i++) { collection.add(Array.get(object, i)); } return unmodifiableCollection(collection); } else { if (length > 0) { Object value = Array.get(object, 0); return convert(value, toType); } else { return convert(\\\"\\\", toType); } } } else if (object instanceof Collection) { int length = ((Collection) object).size(); if (toType.isArray()) { Class cType = toType.getComponentType(); Object array = Array.newInstance(cType, length); Iterator it = ((Collection) object).iterator(); for (int i = 0; i < length; i++) { Object value = it.next(); Array.set(array, i, convert(value, cType)); } return array; } else if (Collection.class.isAssignableFrom(toType)) { Collection collection = allocateCollection(toType); collection.addAll((Collection) object); return unmodifiableCollection(collection); } else { if (length > 0) { Object value; if (object instanceof List) { value = ((List) object).get(0); } else { Iterator it = ((Collection) object).iterator(); value = it.next(); } return convert(value, toType); } else { return convert(\\\"\\\", toType); } } } else if (object instanceof NodeSet) { return convert(((NodeSet) object).getValues(), toType); } else if (object instanceof Pointer) { return convert(((Pointer) object).getValue(), toType); } else if (toType == String.class) { return object.toString(); } else if (object instanceof Boolean) { if (toType == boolean.class) { return object; } boolean value = ((Boolean) object).booleanValue(); return allocateNumber(toType, value ? 1 : 0); } else if (object instanceof Number) { double value = ((Number) object).doubleValue(); if (toType == boolean.class || toType == Boolean.class) { return value == 0.0 ? Boolean.FALSE : Boolean.TRUE; } if (toType.isPrimitive() || Number.class.isAssignableFrom(toType)) { return allocateNumber(toType, value); } } else if (object instanceof Character) { if (toType == char.class) { return object; } } else if (object instanceof String) { Object value = convertStringToPrimitive(object, toType); if (value != null) { return value; } } Converter converter = ConvertUtils.lookup(toType); if (converter != null) { return converter.convert(toType, object); } throw new JXPathTypeConversionException(\\\"Cannot convert \\\" + object.getClass() + \\\" to \\\" + toType); }"
                    ],
                    [
                        0.9838654398918152,
                        "private static String findFactory(String property, String defaultFactory) { try { String systemProp = System.getProperty(property); if (systemProp != null) { if (debug) { System.err.println(\\\"JXPath: found system property\\\" + systemProp); } return systemProp; } } catch (SecurityException se) { } try { String javah = System.getProperty(\\\"java.home\\\"); String configFile = javah + File.separator + \\\"lib\\\" + File.separator + \\\"jxpath.properties\\\"; File f = new File(configFile); if (f.exists()) { Properties props = new Properties(); props.load(new FileInputStream(f)); String factory = props.getProperty(property); if (factory != null) { if (debug) { System.err.println(\\\"JXPath: found java.home property \\\" + factory); } return factory; } } } catch (Exception ex) { if (debug) { ex.printStackTrace(); } } String serviceId = \\\"META-INF/services/\\\" + property; try { ClassLoader cl = JXPathContextFactory.class.getClassLoader(); InputStream is = null; if (cl == null) { is = ClassLoader.getSystemResourceAsStream(serviceId); } else { is = cl.getResourceAsStream(serviceId); } if (is != null) { if (debug) { System.err.println(\\\"JXPath: found \\\" + serviceId); } BufferedReader rd = new BufferedReader(new InputStreamReader(is)); String factory = rd.readLine(); rd.close(); if (factory != null && !\\\"\\\".equals(factory)) { if (debug) { System.err.println(\\\"JXPath: loaded from services: \\\" + factory); } return factory; } } } catch (Exception ex) { if (debug) { ex.printStackTrace(); } } return defaultFactory; }"
                    ],
                    [
                        0.9811854958534241,
                        "public static Method lookupMethod(Class targetClass, String name, Object[] parameters) { if (parameters == null || parameters.length < 1 || parameters[0] == null) { return null; } if (matchType(targetClass, parameters[0]) == NO_MATCH) { return null; } targetClass = TypeUtils.convert(parameters[0], targetClass).getClass(); boolean tryExact = true; int count = parameters.length - 1; Class[] types = new Class[count]; Object[] arguments = new Object[count]; for (int i = 0; i < count; i++) { Object param = parameters[i + 1]; arguments[i] = param; if (param != null) { types[i] = param.getClass(); } else { types[i] = null; tryExact = false; } } Method method = null; if (tryExact) { try { method = targetClass.getMethod(name, types); if (method != null && !Modifier.isStatic(method.getModifiers())) { return method; } } catch (NoSuchMethodException ex) { } } int currentMatch = 0; boolean ambiguous = false; Method[] methods = targetClass.getMethods(); for (int i = 0; i < methods.length; i++) { if (!Modifier.isStatic(methods[i].getModifiers()) && methods[i].getName().equals(name)) { int match = matchParameterTypes(methods[i].getParameterTypes(), arguments); if (match != NO_MATCH) { if (match > currentMatch) { method = methods[i]; currentMatch = match; ambiguous = false; } else if (match == currentMatch) { ambiguous = true; } } } } if (ambiguous) { throw new JXPathException(\\\"Ambigous method call: \\\" + name); } return method; }"
                    ],
                    [
                        0.9805923700332642,
                        "public String asPath() { if (id != null) { return \\\"id('\\\" + escape(id) + \\\"')\\\"; } StringBuffer buffer = new StringBuffer(); if (parent != null) { buffer.append(parent.asPath()); } switch(node.getNodeType()) { case Node.ELEMENT_NODE: if (parent instanceof DOMNodePointer) { if (buffer.length() == 0 || buffer.charAt(buffer.length() - 1) != '/') { buffer.append('/'); } String ln = DOMNodePointer.getLocalName(node); String nsURI = getNamespaceURI(); if (equalStrings(nsURI, getNamespaceResolver().getDefaultNamespaceURI())) { buffer.append(ln); buffer.append('['); buffer.append(getRelativePositionByName()).append(']'); } else { String prefix = getNamespaceResolver().getPrefix(nsURI); if (prefix != null) { buffer.append(prefix); buffer.append(':'); buffer.append(ln); buffer.append('['); buffer.append(getRelativePositionByName()); buffer.append(']'); } else { buffer.append(\\\"node()\\\"); buffer.append('['); buffer.append(getRelativePositionOfElement()); buffer.append(']'); } } } break; case Node.TEXT_NODE: case Node.CDATA_SECTION_NODE: buffer.append(\\\"/text()\\\"); buffer.append('['); buffer.append(getRelativePositionOfTextNode()).append(']'); break; case Node.PROCESSING_INSTRUCTION_NODE: String target = ((ProcessingInstruction) node).getTarget(); buffer.append(\\\"/processing-instruction(\\'\\\"); buffer.append(target).append(\\\"')\\\"); buffer.append('['); buffer.append(getRelativePositionOfPI(target)).append(']'); break; case Node.DOCUMENT_NODE: } return buffer.toString(); }"
                    ]
                ],
                "directly_related_tests": [
                    "org.apache.commons.jxpath.ri.model.dom.DOMModelTest::testGetNode"
                ],
                "generation": {
                    "1": {
                        "prompt": "You are an expert Java developer. Below is a buggy method from a large Java project. This method causes one or more test failures.\nYour task is to fix the bug in this method. Use the provided test failure(s) to guide your reasoning.\n\n---\n\n## Buggy Method\n\n```java\n\n    public static boolean testNode(Node node, NodeTest test) {\n        if (test == null) {\n            return true;\n        }\n        else if (test instanceof NodeNameTest) {\n            if (node.getNodeType() != Node.ELEMENT_NODE) {\n                return false;\n            }\n\n            NodeNameTest nodeNameTest = (NodeNameTest) test;\n            QName testName = nodeNameTest.getNodeName();\n            String namespaceURI = nodeNameTest.getNamespaceURI();\n            boolean wildcard = nodeNameTest.isWildcard();\n            String testPrefix = testName.getPrefix();\n            if (wildcard && testPrefix == null) {\n                return true;\n            }\n\n            if (wildcard\n                || testName.getName()\n                        .equals(DOMNodePointer.getLocalName(node))) {\n                String nodeNS = DOMNodePointer.getNamespaceURI(node);\n                return equalStrings(namespaceURI, nodeNS);\n            }\n        }\n        else if (test instanceof NodeTypeTest) {\n            int nodeType = node.getNodeType();\n            switch (((NodeTypeTest) test).getNodeType()) {\n                case Compiler.NODE_TYPE_NODE :\n                    return nodeType == Node.ELEMENT_NODE;\n                case Compiler.NODE_TYPE_TEXT :\n                    return nodeType == Node.CDATA_SECTION_NODE\n                        || nodeType == Node.TEXT_NODE;\n                case Compiler.NODE_TYPE_COMMENT :\n                    return nodeType == Node.COMMENT_NODE;\n                case Compiler.NODE_TYPE_PI :\n                    return nodeType == Node.PROCESSING_INSTRUCTION_NODE;\n            }\n            return false;\n        }\n        else if (test instanceof ProcessingInstructionTest) {\n            if (node.getNodeType() == Node.PROCESSING_INSTRUCTION_NODE) {\n                String testPI = ((ProcessingInstructionTest) test).getTarget();\n                String nodePI = ((ProcessingInstruction) node).getTarget();\n                return testPI.equals(nodePI);\n            }\n        }\n        return false;\n    }\n\n```\n---\n\n## Failing Test Case(s)\n\n \n#Test method 1:\n```java\n    public void testGetNode() {\n        assertXPathNodeType(context, \"/\", Document.class);\n        assertXPathNodeType(context, \"/vendor/location\", Element.class);\n        assertXPathNodeType(context, \"//location/@name\", Attr.class);\n        assertXPathNodeType(context, \"//vendor\", Element.class);\n    }\n```\n#Error message: java.lang.NullPointerException\n\tat org.apache.commons.jxpath.JXPathTestCase.assertXPathNodeType(JXPathTestCase.java:224)  assertTrue(\"Evaluating <\" + xpath + \"> = \" + actual.getNode().getClass(),                clazz.isAssignableFrom(actual.getNode().getClass()));\n\tat org.apache.commons.jxpath.ri.model.dom.DOMModelTest.testGetNode(DOMModelTest.java:68)  assertXPathNodeType(context, \"//vendor\", Element.class);\n\n---\n\n## Your Goal\n\nFix the buggy method. Return only the fixed Java method. Do not include explanations or other text.\n",
                        "patches": [
                            "\npublic static boolean testNode(Node node, NodeTest test) {\n    if (node == null) {\n        return false;\n    }\n    if (test == null) {\n        return true;\n    } \n    else if (test instanceof NodeNameTest) {\n        if (node.getNodeType() != Node.ELEMENT_NODE) {\n            return false;\n        }\n        \n        NodeNameTest nodeNameTest = (NodeNameTest) test;\n        QName testName = nodeNameTest.getNodeName();\n        String namespaceURI = nodeNameTest.getNamespaceURI();\n        boolean wildcard = nodeNameTest.isWildcard();\n        String testPrefix = testName.getPrefix();\n        if (wildcard && testPrefix == null) {\n            return true;\n        }\n\n        if (wildcard\n            || testName.getName()\n                    .equals(DOMNodePointer.getLocalName(node))) {\n            String nodeNS = DOMNodePointer.getNamespaceURI(node);\n            return equalStrings(namespaceURI, nodeNS);\n        }\n    } \n    else if (test instanceof NodeTypeTest) {\n        int nodeType = node.getNodeType();\n        switch (((NodeTypeTest) test).getNodeType()) {\n            case Compiler.NODE_TYPE_NODE :\n                return nodeType == Node.ELEMENT_NODE || nodeType == Node.DOCUMENT_NODE;\n            case Compiler.NODE_TYPE_TEXT :\n                return nodeType == Node.CDATA_SECTION_NODE\n                    || nodeType == Node.TEXT_NODE;\n            case Compiler.NODE_TYPE_COMMENT :\n                return nodeType == Node.COMMENT_NODE;\n            case Compiler.NODE_TYPE_PI :\n                return nodeType == Node.PROCESSING_INSTRUCTION_NODE;\n        }\n        return false;\n    } \n    else if (test instanceof ProcessingInstructionTest) {\n        if (node.getNodeType() == Node.PROCESSING_INSTRUCTION_NODE) {\n            String testPI = ((ProcessingInstructionTest) test).getTarget();\n            String nodePI = ((ProcessingInstruction) node).getTarget();\n            return testPI.equals(nodePI);\n        }\n    }\n    return false;\n}\n",
                            "\npublic static boolean testNode(Node node, NodeTest test) {\n    if (test == null) {\n        return true;\n    }\n    else if (test instanceof NodeNameTest) {\n        if (node == null || node.getNodeType() != Node.ELEMENT_NODE) {\n            return false;\n        }\n\n        NodeNameTest nodeNameTest = (NodeNameTest) test;\n        QName testName = nodeNameTest.getNodeName();\n        String namespaceURI = nodeNameTest.getNamespaceURI();\n        boolean wildcard = nodeNameTest.isWildcard();\n        String testPrefix = testName.getPrefix();\n        if (wildcard && testPrefix == null) {\n            return true;\n        }\n\n        if (wildcard\n            || testName.getName()\n                    .equals(DOMNodePointer.getLocalName(node))) {\n            String nodeNS = DOMNodePointer.getNamespaceURI(node);\n            return equalStrings(namespaceURI, nodeNS);\n        }\n    }\n    else if (test instanceof NodeTypeTest) {\n        if (node == null) {\n            return false;\n        }\n        int nodeType = node.getNodeType();\n        switch (((NodeTypeTest) test).getNodeType()) {\n            case Compiler.NODE_TYPE_NODE :\n                return nodeType == Node.ELEMENT_NODE;\n            case Compiler.NODE_TYPE_TEXT :\n                return nodeType == Node.CDATA_SECTION_NODE\n                    || nodeType == Node.TEXT_NODE;\n            case Compiler.NODE_TYPE_COMMENT :\n                return nodeType == Node.COMMENT_NODE;\n            case Compiler.NODE_TYPE_PI :\n                return nodeType == Node.PROCESSING_INSTRUCTION_NODE;\n        }\n        return false;\n    }\n    else if (test instanceof ProcessingInstructionTest) {\n        if (node != null && node.getNodeType() == Node.PROCESSING_INSTRUCTION_NODE) {\n            String testPI = ((ProcessingInstructionTest) test).getTarget();\n            String nodePI = ((ProcessingInstruction) node).getTarget();\n            return testPI.equals(nodePI);\n        }\n    }\n    return false;\n}\n",
                            "\npublic static boolean testNode(Node node, NodeTest test) {\n    if (test == null) {\n        return true;\n    }\n    else if (test instanceof NodeNameTest) {\n        if (node.getNodeType() != Node.ELEMENT_NODE) {\n            return false;\n        }\n\n        NodeNameTest nodeNameTest = (NodeNameTest) test;\n        QName testName = nodeNameTest.getNodeName();\n        String namespaceURI = nodeNameTest.getNamespaceURI();\n        boolean wildcard = nodeNameTest.isWildcard();\n        String testPrefix = testName.getPrefix();\n        if (wildcard && testPrefix == null) {\n            return true;\n        }\n\n        if (wildcard\n            || testName.getName()\n                    .equals(DOMNodePointer.getLocalName(node))) {\n            String nodeNS = DOMNodePointer.getNamespaceURI(node);\n            return equalStrings(namespaceURI, nodeNS);\n        }\n    }\n    else if (test instanceof NodeTypeTest) {\n        int nodeType = node.getNodeType();\n        switch (((NodeTypeTest) test).getNodeType()) {\n            case Compiler.NODE_TYPE_NODE :\n                return true;  // Fix: Allow any node type\n            case Compiler.NODE_TYPE_TEXT :\n                return nodeType == Node.CDATA_SECTION_NODE\n                    || nodeType == Node.TEXT_NODE;\n            case Compiler.NODE_TYPE_COMMENT :\n                return nodeType == Node.COMMENT_NODE;\n            case Compiler.NODE_TYPE_PI :\n                return nodeType == Node.PROCESSING_INSTRUCTION_NODE;\n        }\n        return false;\n    }\n    else if (test instanceof ProcessingInstructionTest) {\n        if (node.getNodeType() == Node.PROCESSING_INSTRUCTION_NODE) {\n            String testPI = ((ProcessingInstructionTest) test).getTarget();\n            String nodePI = ((ProcessingInstruction) node).getTarget();\n            return testPI.equals(nodePI);\n        }\n    }\n    return false;\n}\n",
                            "\npublic static boolean testNode(Node node, NodeTest test) {\n    if (test == null) {\n        return true;\n    }\n    else if (test instanceof NodeNameTest) {\n        if (node.getNodeType() != Node.ELEMENT_NODE) {\n            return false;\n        }\n\n        NodeNameTest nodeNameTest = (NodeNameTest) test;\n        QName testName = nodeNameTest.getNodeName();\n        String namespaceURI = nodeNameTest.getNamespaceURI();\n        boolean wildcard = nodeNameTest.isWildcard();\n        String testPrefix = testName.getPrefix();\n        if (wildcard && (testPrefix == null || testPrefix.isEmpty())) {\n            return true;\n        }\n\n        if (wildcard\n            || testName.getName()\n                    .equals(DOMNodePointer.getLocalName(node))) {\n            String nodeNS = DOMNodePointer.getNamespaceURI(node);\n            return equalStrings(namespaceURI, nodeNS);\n        }\n    }\n    else if (test instanceof NodeTypeTest) {\n        int nodeType = node.getNodeType();\n        switch (((NodeTypeTest) test).getNodeType()) {\n            case Compiler.NODE_TYPE_NODE :\n                return nodeType == Node.ELEMENT_NODE || nodeType == Node.DOCUMENT_NODE;\n            case Compiler.NODE_TYPE_TEXT :\n                return nodeType == Node.CDATA_SECTION_NODE\n                    || nodeType == Node.TEXT_NODE;\n            case Compiler.NODE_TYPE_COMMENT :\n                return nodeType == Node.COMMENT_NODE;\n            case Compiler.NODE_TYPE_PI :\n                return nodeType == Node.PROCESSING_INSTRUCTION_NODE;\n        }\n        return false;\n    }\n    else if (test instanceof ProcessingInstructionTest) {\n        if (node.getNodeType() == Node.PROCESSING_INSTRUCTION_NODE) {\n            String testPI = ((ProcessingInstructionTest) test).getTarget();\n            String nodePI = ((ProcessingInstruction) node).getTarget();\n            return testPI.equals(nodePI);\n        }\n    }\n    return false;\n}\n",
                            "\npublic static boolean testNode(Node node, NodeTest test) {\n    if (test == null) {\n        return true;\n    }\n    else if (test instanceof NodeNameTest) {\n        if (node.getNodeType() != Node.ELEMENT_NODE) {\n            return false;\n        }\n\n        NodeNameTest nodeNameTest = (NodeNameTest) test;\n        QName testName = nodeNameTest.getNodeName();\n        String namespaceURI = nodeNameTest.getNamespaceURI();\n        boolean wildcard = nodeNameTest.isWildcard();\n        String testPrefix = testName.getPrefix();\n        if (wildcard && testPrefix == null) {\n            return true;\n        }\n\n        if (wildcard\n            || testName.getName()\n                    .equals(DOMNodePointer.getLocalName(node))) {\n            String nodeNS = DOMNodePointer.getNamespaceURI(node);\n            return equalStrings(namespaceURI, nodeNS);\n        }\n    }\n    else if (test instanceof NodeTypeTest) {\n        int nodeType = node.getNodeType();\n        switch (((NodeTypeTest) test).getNodeType()) {\n            case Compiler.NODE_TYPE_NODE :\n                return nodeType == Node.ELEMENT_NODE || nodeType == Node.DOCUMENT_NODE;\n            case Compiler.NODE_TYPE_TEXT :\n                return nodeType == Node.CDATA_SECTION_NODE\n                    || nodeType == Node.TEXT_NODE;\n            case Compiler.NODE_TYPE_COMMENT :\n                return nodeType == Node.COMMENT_NODE;\n            case Compiler.NODE_TYPE_PI :\n                return nodeType == Node.PROCESSING_INSTRUCTION_NODE;\n        }\n        return false;\n    }\n    else if (test instanceof ProcessingInstructionTest) {\n        if (node.getNodeType() == Node.PROCESSING_INSTRUCTION_NODE) {\n            String testPI = ((ProcessingInstructionTest) test).getTarget();\n            String nodePI = ((ProcessingInstruction) node).getTarget();\n            return testPI.equals(nodePI);\n        }\n    }\n    return false;\n}\n",
                            "\npublic static boolean testNode(Node node, NodeTest test) {\n    if (test == null) {\n        return true;\n    } \n    else if (test instanceof NodeNameTest) {\n        if (node.getNodeType() != Node.ELEMENT_NODE) {\n            return false;\n        }\n\n        NodeNameTest nodeNameTest = (NodeNameTest) test;\n        QName testName = nodeNameTest.getNodeName();\n        String namespaceURI = nodeNameTest.getNamespaceURI();\n        boolean wildcard = nodeNameTest.isWildcard();\n        String testPrefix = testName != null ? testName.getPrefix() : null;\n        if (wildcard && testPrefix == null) {\n            return true;\n        }\n\n        if (wildcard\n            || (testName != null \n                && testName.getName().equals(DOMNodePointer.getLocalName(node)))) {\n            String nodeNS = DOMNodePointer.getNamespaceURI(node);\n            return equalStrings(namespaceURI, nodeNS);\n        }\n    } \n    else if (test instanceof NodeTypeTest) {\n        int nodeType = node.getNodeType();\n        switch (((NodeTypeTest) test).getNodeType()) {\n            case Compiler.NODE_TYPE_NODE:\n                return true;\n            case Compiler.NODE_TYPE_TEXT:\n                return nodeType == Node.CDATA_SECTION_NODE\n                    || nodeType == Node.TEXT_NODE;\n            case Compiler.NODE_TYPE_COMMENT:\n                return nodeType == Node.COMMENT_NODE;\n            case Compiler.NODE_TYPE_PI:\n                return nodeType == Node.PROCESSING_INSTRUCTION_NODE;\n        }\n        return false;\n    } \n    else if (test instanceof ProcessingInstructionTest) {\n        if (node.getNodeType() == Node.PROCESSING_INSTRUCTION_NODE) {\n            String testPI = ((ProcessingInstructionTest) test).getTarget();\n            String nodePI = ((ProcessingInstruction) node).getTarget();\n            return testPI.equals(nodePI);\n        }\n    }\n    return false;\n}\n",
                            "\npublic static boolean testNode(Node node, NodeTest test) {\n    if (test == null) {\n        return true;\n    }\n    else if (test instanceof NodeNameTest) {\n        if (node.getNodeType() != Node.ELEMENT_NODE) {\n            return false;\n        }\n\n        NodeNameTest nodeNameTest = (NodeNameTest) test;\n        QName testName = nodeNameTest.getNodeName();\n        String namespaceURI = nodeNameTest.getNamespaceURI();\n        boolean wildcard = nodeNameTest.isWildcard();\n        String testPrefix = testName.getPrefix();\n        if (wildcard && testPrefix == null) {\n            return true;\n        }\n\n        if (wildcard\n            || testName.getLocalPart()  // Changed from getName() to getLocalPart()\n                    .equals(DOMNodePointer.getLocalName(node))) {\n            String nodeNS = DOMNodePointer.getNamespaceURI(node);\n            return equalStrings(namespaceURI, nodeNS);\n        }\n    }\n    else if (test instanceof NodeTypeTest) {\n        int nodeType = node.getNodeType();\n        switch (((NodeTypeTest) test).getNodeType()) {\n            case Compiler.NODE_TYPE_NODE :\n                return nodeType == Node.ELEMENT_NODE || nodeType == Node.DOCUMENT_NODE; // Added support for document node\n            case Compiler.NODE_TYPE_TEXT :\n                return nodeType == Node.CDATA_SECTION_NODE\n                    || nodeType == Node.TEXT_NODE;\n            case Compiler.NODE_TYPE_COMMENT :\n                return nodeType == Node.COMMENT_NODE;\n            case Compiler.NODE_TYPE_PI :\n                return nodeType == Node.PROCESSING_INSTRUCTION_NODE;\n        }\n        return false;\n    }\n    else if (test instanceof ProcessingInstructionTest) {\n        if (node.getNodeType() == Node.PROCESSING_INSTRUCTION_NODE) {\n            String testPI = ((ProcessingInstructionTest) test).getTarget();\n            String nodePI = ((ProcessingInstruction) node).getTarget();\n            return testPI.equals(nodePI);\n        }\n    }\n    return false;\n}\n",
                            "\npublic static boolean testNode(Node node, NodeTest test) {\n    if (node == null) {\n        return false;\n    }\n    if (test == null) {\n        return true;\n    }\n    else if (test instanceof NodeNameTest) {\n        if (node.getNodeType() != Node.ELEMENT_NODE) {\n            return false;\n        }\n\n        NodeNameTest nodeNameTest = (NodeNameTest) test;\n        QName testName = nodeNameTest.getNodeName();\n        String namespaceURI = nodeNameTest.getNamespaceURI();\n        boolean wildcard = nodeNameTest.isWildcard();\n        String testPrefix = testName.getPrefix();\n        if (wildcard && testPrefix == null) {\n            return true;\n        }\n\n        if (wildcard\n            || testName.getName()\n                    .equals(DOMNodePointer.getLocalName(node))) {\n            String nodeNS = DOMNodePointer.getNamespaceURI(node);\n            return equalStrings(namespaceURI, nodeNS);\n        }\n    }\n    else if (test instanceof NodeTypeTest) {\n        int nodeType = node.getNodeType();\n        switch (((NodeTypeTest) test).getNodeType()) {\n            case Compiler.NODE_TYPE_NODE :\n                return true; // Match any node, not just elements\n            case Compiler.NODE_TYPE_TEXT :\n                return nodeType == Node.CDATA_SECTION_NODE\n                    || nodeType == Node.TEXT_NODE;\n            case Compiler.NODE_TYPE_COMMENT :\n                return nodeType == Node.COMMENT_NODE;\n            case Compiler.NODE_TYPE_PI :\n                return nodeType == Node.PROCESSING_INSTRUCTION_NODE;\n        }\n        return false;\n    }\n    else if (test instanceof ProcessingInstructionTest) {\n        if (node.getNodeType() == Node.PROCESSING_INSTRUCTION_NODE) {\n            String testPI = ((ProcessingInstructionTest) test).getTarget();\n            String nodePI = ((ProcessingInstruction) node).getTarget();\n            return testPI.equals(nodePI);\n        }\n    }\n    return false;\n}\n",
                            "\npublic static boolean testNode(Node node, NodeTest test) {\n    if (test == null) {\n        return true;\n    }\n    else if (test instanceof NodeNameTest) {\n        if (node.getNodeType() != Node.ELEMENT_NODE) {\n            return false;\n        }\n\n        NodeNameTest nodeNameTest = (NodeNameTest) test;\n        QName testName = nodeNameTest.getNodeName();\n        String namespaceURI = nodeNameTest.getNamespaceURI();\n        boolean wildcard = nodeNameTest.isWildcard();\n        String testPrefix = testName.getPrefix();\n        if (wildcard && (testPrefix == null || testName.getName().equals(\"\"))) {\n            return true;\n        }\n\n        if (wildcard\n            || testName.getName()\n                    .equals(DOMNodePointer.getLocalName(node))) {\n            String nodeNS = DOMNodePointer.getNamespaceURI(node);\n            return equalStrings(namespaceURI, nodeNS);\n        }\n    }\n    else if (test instanceof NodeTypeTest) {\n        int nodeType = node.getNodeType();\n        switch (((NodeTypeTest) test).getNodeType()) {\n            case Compiler.NODE_TYPE_NODE :\n                return nodeType == Node.ELEMENT_NODE;\n            case Compiler.NODE_TYPE_TEXT :\n                return nodeType == Node.CDATA_SECTION_NODE\n                    || nodeType == Node.TEXT_NODE;\n            case Compiler.NODE_TYPE_COMMENT :\n                return nodeType == Node.COMMENT_NODE;\n            case Compiler.NODE_TYPE_PI :\n                return nodeType == Node.PROCESSING_INSTRUCTION_NODE;\n        }\n        return false;\n    }\n    else if (test instanceof ProcessingInstructionTest) {\n        if (node.getNodeType() == Node.PROCESSING_INSTRUCTION_NODE) {\n            String testPI = ((ProcessingInstructionTest) test).getTarget();\n            String nodePI = ((ProcessingInstruction) node).getTarget();\n            return testPI.equals(nodePI);\n        }\n    }\n    return false;\n}\n",
                            "\npublic static boolean testNode(Node node, NodeTest test) {\n    if (test == null) {\n        return true;\n    }\n    else if (test instanceof NodeNameTest) {\n        if (node.getNodeType() != Node.ELEMENT_NODE) {\n            return false;\n        }\n\n        NodeNameTest nodeNameTest = (NodeNameTest) test;\n        QName testName = nodeNameTest.getNodeName();\n        String namespaceURI = nodeNameTest.getNamespaceURI();\n        boolean wildcard = nodeNameTest.isWildcard();\n        String testPrefix = testName.getPrefix();\n        if (wildcard && testPrefix == null) {\n            return true;\n        }\n\n        if (wildcard\n            || testName.getName()\n                    .equals(DOMNodePointer.getLocalName(node))) {\n            String nodeNS = DOMNodePointer.getNamespaceURI(node);\n            String testNS = namespaceURI != null ? namespaceURI : \"\";\n            return equalStrings(testNS, nodeNS);\n        }\n    }\n    else if (test instanceof NodeTypeTest) {\n        int nodeType = node.getNodeType();\n        switch (((NodeTypeTest) test).getNodeType()) {\n            case Compiler.NODE_TYPE_NODE :\n                return nodeType == Node.ELEMENT_NODE;\n            case Compiler.NODE_TYPE_TEXT :\n                return nodeType == Node.CDATA_SECTION_NODE\n                    || nodeType == Node.TEXT_NODE;\n            case Compiler.NODE_TYPE_COMMENT :\n                return nodeType == Node.COMMENT_NODE;\n            case Compiler.NODE_TYPE_PI :\n                return nodeType == Node.PROCESSING_INSTRUCTION_NODE;\n        }\n        return false;\n    }\n    else if (test instanceof ProcessingInstructionTest) {\n        if (node.getNodeType() == Node.PROCESSING_INSTRUCTION_NODE) {\n            String testPI = ((ProcessingInstructionTest) test).getTarget();\n            String nodePI = ((ProcessingInstruction) node).getTarget();\n            return testPI.equals(nodePI);\n        }\n    }\n    return false;\n}\n"
                        ],
                        "plausible_patches": [
                            "\npublic static boolean testNode(Node node, NodeTest test) {\n    if (node == null) {\n        return false;\n    }\n    if (test == null) {\n        return true;\n    } \n    else if (test instanceof NodeNameTest) {\n        if (node.getNodeType() != Node.ELEMENT_NODE) {\n            return false;\n        }\n        \n        NodeNameTest nodeNameTest = (NodeNameTest) test;\n        QName testName = nodeNameTest.getNodeName();\n        String namespaceURI = nodeNameTest.getNamespaceURI();\n        boolean wildcard = nodeNameTest.isWildcard();\n        String testPrefix = testName.getPrefix();\n        if (wildcard && testPrefix == null) {\n            return true;\n        }\n\n        if (wildcard\n            || testName.getName()\n                    .equals(DOMNodePointer.getLocalName(node))) {\n            String nodeNS = DOMNodePointer.getNamespaceURI(node);\n            return equalStrings(namespaceURI, nodeNS);\n        }\n    } \n    else if (test instanceof NodeTypeTest) {\n        int nodeType = node.getNodeType();\n        switch (((NodeTypeTest) test).getNodeType()) {\n            case Compiler.NODE_TYPE_NODE :\n                return nodeType == Node.ELEMENT_NODE || nodeType == Node.DOCUMENT_NODE;\n            case Compiler.NODE_TYPE_TEXT :\n                return nodeType == Node.CDATA_SECTION_NODE\n                    || nodeType == Node.TEXT_NODE;\n            case Compiler.NODE_TYPE_COMMENT :\n                return nodeType == Node.COMMENT_NODE;\n            case Compiler.NODE_TYPE_PI :\n                return nodeType == Node.PROCESSING_INSTRUCTION_NODE;\n        }\n        return false;\n    } \n    else if (test instanceof ProcessingInstructionTest) {\n        if (node.getNodeType() == Node.PROCESSING_INSTRUCTION_NODE) {\n            String testPI = ((ProcessingInstructionTest) test).getTarget();\n            String nodePI = ((ProcessingInstruction) node).getTarget();\n            return testPI.equals(nodePI);\n        }\n    }\n    return false;\n}\n",
                            "\npublic static boolean testNode(Node node, NodeTest test) {\n    if (test == null) {\n        return true;\n    }\n    else if (test instanceof NodeNameTest) {\n        if (node.getNodeType() != Node.ELEMENT_NODE) {\n            return false;\n        }\n\n        NodeNameTest nodeNameTest = (NodeNameTest) test;\n        QName testName = nodeNameTest.getNodeName();\n        String namespaceURI = nodeNameTest.getNamespaceURI();\n        boolean wildcard = nodeNameTest.isWildcard();\n        String testPrefix = testName.getPrefix();\n        if (wildcard && testPrefix == null) {\n            return true;\n        }\n\n        if (wildcard\n            || testName.getName()\n                    .equals(DOMNodePointer.getLocalName(node))) {\n            String nodeNS = DOMNodePointer.getNamespaceURI(node);\n            return equalStrings(namespaceURI, nodeNS);\n        }\n    }\n    else if (test instanceof NodeTypeTest) {\n        int nodeType = node.getNodeType();\n        switch (((NodeTypeTest) test).getNodeType()) {\n            case Compiler.NODE_TYPE_NODE :\n                return true;  // Fix: Allow any node type\n            case Compiler.NODE_TYPE_TEXT :\n                return nodeType == Node.CDATA_SECTION_NODE\n                    || nodeType == Node.TEXT_NODE;\n            case Compiler.NODE_TYPE_COMMENT :\n                return nodeType == Node.COMMENT_NODE;\n            case Compiler.NODE_TYPE_PI :\n                return nodeType == Node.PROCESSING_INSTRUCTION_NODE;\n        }\n        return false;\n    }\n    else if (test instanceof ProcessingInstructionTest) {\n        if (node.getNodeType() == Node.PROCESSING_INSTRUCTION_NODE) {\n            String testPI = ((ProcessingInstructionTest) test).getTarget();\n            String nodePI = ((ProcessingInstruction) node).getTarget();\n            return testPI.equals(nodePI);\n        }\n    }\n    return false;\n}\n",
                            "\npublic static boolean testNode(Node node, NodeTest test) {\n    if (test == null) {\n        return true;\n    }\n    else if (test instanceof NodeNameTest) {\n        if (node.getNodeType() != Node.ELEMENT_NODE) {\n            return false;\n        }\n\n        NodeNameTest nodeNameTest = (NodeNameTest) test;\n        QName testName = nodeNameTest.getNodeName();\n        String namespaceURI = nodeNameTest.getNamespaceURI();\n        boolean wildcard = nodeNameTest.isWildcard();\n        String testPrefix = testName.getPrefix();\n        if (wildcard && (testPrefix == null || testPrefix.isEmpty())) {\n            return true;\n        }\n\n        if (wildcard\n            || testName.getName()\n                    .equals(DOMNodePointer.getLocalName(node))) {\n            String nodeNS = DOMNodePointer.getNamespaceURI(node);\n            return equalStrings(namespaceURI, nodeNS);\n        }\n    }\n    else if (test instanceof NodeTypeTest) {\n        int nodeType = node.getNodeType();\n        switch (((NodeTypeTest) test).getNodeType()) {\n            case Compiler.NODE_TYPE_NODE :\n                return nodeType == Node.ELEMENT_NODE || nodeType == Node.DOCUMENT_NODE;\n            case Compiler.NODE_TYPE_TEXT :\n                return nodeType == Node.CDATA_SECTION_NODE\n                    || nodeType == Node.TEXT_NODE;\n            case Compiler.NODE_TYPE_COMMENT :\n                return nodeType == Node.COMMENT_NODE;\n            case Compiler.NODE_TYPE_PI :\n                return nodeType == Node.PROCESSING_INSTRUCTION_NODE;\n        }\n        return false;\n    }\n    else if (test instanceof ProcessingInstructionTest) {\n        if (node.getNodeType() == Node.PROCESSING_INSTRUCTION_NODE) {\n            String testPI = ((ProcessingInstructionTest) test).getTarget();\n            String nodePI = ((ProcessingInstruction) node).getTarget();\n            return testPI.equals(nodePI);\n        }\n    }\n    return false;\n}\n",
                            "\npublic static boolean testNode(Node node, NodeTest test) {\n    if (test == null) {\n        return true;\n    }\n    else if (test instanceof NodeNameTest) {\n        if (node.getNodeType() != Node.ELEMENT_NODE) {\n            return false;\n        }\n\n        NodeNameTest nodeNameTest = (NodeNameTest) test;\n        QName testName = nodeNameTest.getNodeName();\n        String namespaceURI = nodeNameTest.getNamespaceURI();\n        boolean wildcard = nodeNameTest.isWildcard();\n        String testPrefix = testName.getPrefix();\n        if (wildcard && testPrefix == null) {\n            return true;\n        }\n\n        if (wildcard\n            || testName.getName()\n                    .equals(DOMNodePointer.getLocalName(node))) {\n            String nodeNS = DOMNodePointer.getNamespaceURI(node);\n            return equalStrings(namespaceURI, nodeNS);\n        }\n    }\n    else if (test instanceof NodeTypeTest) {\n        int nodeType = node.getNodeType();\n        switch (((NodeTypeTest) test).getNodeType()) {\n            case Compiler.NODE_TYPE_NODE :\n                return nodeType == Node.ELEMENT_NODE || nodeType == Node.DOCUMENT_NODE;\n            case Compiler.NODE_TYPE_TEXT :\n                return nodeType == Node.CDATA_SECTION_NODE\n                    || nodeType == Node.TEXT_NODE;\n            case Compiler.NODE_TYPE_COMMENT :\n                return nodeType == Node.COMMENT_NODE;\n            case Compiler.NODE_TYPE_PI :\n                return nodeType == Node.PROCESSING_INSTRUCTION_NODE;\n        }\n        return false;\n    }\n    else if (test instanceof ProcessingInstructionTest) {\n        if (node.getNodeType() == Node.PROCESSING_INSTRUCTION_NODE) {\n            String testPI = ((ProcessingInstructionTest) test).getTarget();\n            String nodePI = ((ProcessingInstruction) node).getTarget();\n            return testPI.equals(nodePI);\n        }\n    }\n    return false;\n}\n",
                            "\npublic static boolean testNode(Node node, NodeTest test) {\n    if (test == null) {\n        return true;\n    } \n    else if (test instanceof NodeNameTest) {\n        if (node.getNodeType() != Node.ELEMENT_NODE) {\n            return false;\n        }\n\n        NodeNameTest nodeNameTest = (NodeNameTest) test;\n        QName testName = nodeNameTest.getNodeName();\n        String namespaceURI = nodeNameTest.getNamespaceURI();\n        boolean wildcard = nodeNameTest.isWildcard();\n        String testPrefix = testName != null ? testName.getPrefix() : null;\n        if (wildcard && testPrefix == null) {\n            return true;\n        }\n\n        if (wildcard\n            || (testName != null \n                && testName.getName().equals(DOMNodePointer.getLocalName(node)))) {\n            String nodeNS = DOMNodePointer.getNamespaceURI(node);\n            return equalStrings(namespaceURI, nodeNS);\n        }\n    } \n    else if (test instanceof NodeTypeTest) {\n        int nodeType = node.getNodeType();\n        switch (((NodeTypeTest) test).getNodeType()) {\n            case Compiler.NODE_TYPE_NODE:\n                return true;\n            case Compiler.NODE_TYPE_TEXT:\n                return nodeType == Node.CDATA_SECTION_NODE\n                    || nodeType == Node.TEXT_NODE;\n            case Compiler.NODE_TYPE_COMMENT:\n                return nodeType == Node.COMMENT_NODE;\n            case Compiler.NODE_TYPE_PI:\n                return nodeType == Node.PROCESSING_INSTRUCTION_NODE;\n        }\n        return false;\n    } \n    else if (test instanceof ProcessingInstructionTest) {\n        if (node.getNodeType() == Node.PROCESSING_INSTRUCTION_NODE) {\n            String testPI = ((ProcessingInstructionTest) test).getTarget();\n            String nodePI = ((ProcessingInstruction) node).getTarget();\n            return testPI.equals(nodePI);\n        }\n    }\n    return false;\n}\n",
                            "\npublic static boolean testNode(Node node, NodeTest test) {\n    if (node == null) {\n        return false;\n    }\n    if (test == null) {\n        return true;\n    }\n    else if (test instanceof NodeNameTest) {\n        if (node.getNodeType() != Node.ELEMENT_NODE) {\n            return false;\n        }\n\n        NodeNameTest nodeNameTest = (NodeNameTest) test;\n        QName testName = nodeNameTest.getNodeName();\n        String namespaceURI = nodeNameTest.getNamespaceURI();\n        boolean wildcard = nodeNameTest.isWildcard();\n        String testPrefix = testName.getPrefix();\n        if (wildcard && testPrefix == null) {\n            return true;\n        }\n\n        if (wildcard\n            || testName.getName()\n                    .equals(DOMNodePointer.getLocalName(node))) {\n            String nodeNS = DOMNodePointer.getNamespaceURI(node);\n            return equalStrings(namespaceURI, nodeNS);\n        }\n    }\n    else if (test instanceof NodeTypeTest) {\n        int nodeType = node.getNodeType();\n        switch (((NodeTypeTest) test).getNodeType()) {\n            case Compiler.NODE_TYPE_NODE :\n                return true; // Match any node, not just elements\n            case Compiler.NODE_TYPE_TEXT :\n                return nodeType == Node.CDATA_SECTION_NODE\n                    || nodeType == Node.TEXT_NODE;\n            case Compiler.NODE_TYPE_COMMENT :\n                return nodeType == Node.COMMENT_NODE;\n            case Compiler.NODE_TYPE_PI :\n                return nodeType == Node.PROCESSING_INSTRUCTION_NODE;\n        }\n        return false;\n    }\n    else if (test instanceof ProcessingInstructionTest) {\n        if (node.getNodeType() == Node.PROCESSING_INSTRUCTION_NODE) {\n            String testPI = ((ProcessingInstructionTest) test).getTarget();\n            String nodePI = ((ProcessingInstruction) node).getTarget();\n            return testPI.equals(nodePI);\n        }\n    }\n    return false;\n}\n"
                        ]
                    }
                }
            },
            {
                "path": "src/java/org/apache/commons/jxpath/ri/model/jdom/JDOMNodePointer.java",
                "start_loc": 343,
                "end_loc": 395,
                "buggy_function": "    public static boolean testNode(\n        NodePointer pointer,\n        Object node,\n        NodeTest test) \n    {\n        if (test == null) {\n            return true;\n        }\n        else if (test instanceof NodeNameTest) {\n            if (!(node instanceof Element)) {\n                return false;\n            }\n\n            NodeNameTest nodeNameTest = (NodeNameTest) test;\n            QName testName = nodeNameTest.getNodeName();\n            String namespaceURI = nodeNameTest.getNamespaceURI();\n            boolean wildcard = nodeNameTest.isWildcard();\n            String testPrefix = testName.getPrefix();\n            if (wildcard && testPrefix == null) {\n                return true;\n            }\n\n            if (wildcard\n                || testName.getName()\n                        .equals(JDOMNodePointer.getLocalName(node))) {\n                String nodeNS = JDOMNodePointer.getNamespaceURI(node);\n                return equalStrings(namespaceURI, nodeNS);\n            }\n\n        }\n        else if (test instanceof NodeTypeTest) {\n            switch (((NodeTypeTest) test).getNodeType()) {\n                case Compiler.NODE_TYPE_NODE :\n                    return node instanceof Element;\n                case Compiler.NODE_TYPE_TEXT :\n                    return (node instanceof Text) || (node instanceof CDATA);\n                case Compiler.NODE_TYPE_COMMENT :\n                    return node instanceof Comment;\n                case Compiler.NODE_TYPE_PI :\n                    return node instanceof ProcessingInstruction;\n            }\n            return false;\n        }\n        else if (test instanceof ProcessingInstructionTest) {\n            if (node instanceof ProcessingInstruction) {\n                String testPI = ((ProcessingInstructionTest) test).getTarget();\n                String nodePI = ((ProcessingInstruction) node).getTarget();\n                return testPI.equals(nodePI);\n            }\n        }\n\n        return false;\n    }\n",
                "fixed_function": "    public static boolean testNode(\n        NodePointer pointer,\n        Object node,\n        NodeTest test) \n    {\n        if (test == null) {\n            return true;\n        }\n        else if (test instanceof NodeNameTest) {\n            if (!(node instanceof Element)) {\n                return false;\n            }\n\n            NodeNameTest nodeNameTest = (NodeNameTest) test;\n            QName testName = nodeNameTest.getNodeName();\n            String namespaceURI = nodeNameTest.getNamespaceURI();\n            boolean wildcard = nodeNameTest.isWildcard();\n            String testPrefix = testName.getPrefix();\n            if (wildcard && testPrefix == null) {\n                return true;\n            }\n\n            if (wildcard\n                || testName.getName()\n                        .equals(JDOMNodePointer.getLocalName(node))) {\n                String nodeNS = JDOMNodePointer.getNamespaceURI(node);\n                return equalStrings(namespaceURI, nodeNS);\n            }\n\n        }\n        else if (test instanceof NodeTypeTest) {\n            switch (((NodeTypeTest) test).getNodeType()) {\n                case Compiler.NODE_TYPE_NODE :\n                    return (node instanceof Element) || (node instanceof Document);\n                case Compiler.NODE_TYPE_TEXT :\n                    return (node instanceof Text) || (node instanceof CDATA);\n                case Compiler.NODE_TYPE_COMMENT :\n                    return node instanceof Comment;\n                case Compiler.NODE_TYPE_PI :\n                    return node instanceof ProcessingInstruction;\n            }\n            return false;\n        }\n        else if (test instanceof ProcessingInstructionTest) {\n            if (node instanceof ProcessingInstruction) {\n                String testPI = ((ProcessingInstructionTest) test).getTarget();\n                String nodePI = ((ProcessingInstruction) node).getTarget();\n                return testPI.equals(nodePI);\n            }\n        }\n\n        return false;\n    }\n",
                "comment": "",
                "normalized_body": [
                    "public static boolean testNode(NodePointer pointer, Object node, NodeTest test) { if (test == null) { return true; } else if (test instanceof NodeNameTest) { if (!(node instanceof Element)) { return false; } NodeNameTest nodeNameTest = (NodeNameTest) test; QName testName = nodeNameTest.getNodeName(); String namespaceURI = nodeNameTest.getNamespaceURI(); boolean wildcard = nodeNameTest.isWildcard(); String testPrefix = testName.getPrefix(); if (wildcard && testPrefix == null) { return true; } if (wildcard || testName.getName().equals(JDOMNodePointer.getLocalName(node))) { String nodeNS = JDOMNodePointer.getNamespaceURI(node); return equalStrings(namespaceURI, nodeNS); } } else if (test instanceof NodeTypeTest) { switch(((NodeTypeTest) test).getNodeType()) { case Compiler.NODE_TYPE_NODE: return node instanceof Element; case Compiler.NODE_TYPE_TEXT: return (node instanceof Text) || (node instanceof CDATA); case Compiler.NODE_TYPE_COMMENT: return node instanceof Comment; case Compiler.NODE_TYPE_PI: return node instanceof ProcessingInstruction; } return false; } else if (test instanceof ProcessingInstructionTest) { if (node instanceof ProcessingInstruction) { String testPI = ((ProcessingInstructionTest) test).getTarget(); String nodePI = ((ProcessingInstruction) node).getTarget(); return testPI.equals(nodePI); } } return false; }"
                ],
                "top_similar_methods": [
                    [
                        0.9999999403953552,
                        "public static boolean testNode(NodePointer pointer, Object node, NodeTest test) { if (test == null) { return true; } else if (test instanceof NodeNameTest) { if (!(node instanceof Element)) { return false; } NodeNameTest nodeNameTest = (NodeNameTest) test; QName testName = nodeNameTest.getNodeName(); String namespaceURI = nodeNameTest.getNamespaceURI(); boolean wildcard = nodeNameTest.isWildcard(); String testPrefix = testName.getPrefix(); if (wildcard && testPrefix == null) { return true; } if (wildcard || testName.getName().equals(JDOMNodePointer.getLocalName(node))) { String nodeNS = JDOMNodePointer.getNamespaceURI(node); return equalStrings(namespaceURI, nodeNS); } } else if (test instanceof NodeTypeTest) { switch(((NodeTypeTest) test).getNodeType()) { case Compiler.NODE_TYPE_NODE: return node instanceof Element; case Compiler.NODE_TYPE_TEXT: return (node instanceof Text) || (node instanceof CDATA); case Compiler.NODE_TYPE_COMMENT: return node instanceof Comment; case Compiler.NODE_TYPE_PI: return node instanceof ProcessingInstruction; } return false; } else if (test instanceof ProcessingInstructionTest) { if (node instanceof ProcessingInstruction) { String testPI = ((ProcessingInstructionTest) test).getTarget(); String nodePI = ((ProcessingInstruction) node).getTarget(); return testPI.equals(nodePI); } } return false; }"
                    ],
                    [
                        0.9878429174423218,
                        "public static boolean testNode(Node node, NodeTest test) { if (test == null) { return true; } else if (test instanceof NodeNameTest) { if (node.getNodeType() != Node.ELEMENT_NODE) { return false; } NodeNameTest nodeNameTest = (NodeNameTest) test; QName testName = nodeNameTest.getNodeName(); String namespaceURI = nodeNameTest.getNamespaceURI(); boolean wildcard = nodeNameTest.isWildcard(); String testPrefix = testName.getPrefix(); if (wildcard && testPrefix == null) { return true; } if (wildcard || testName.getName().equals(DOMNodePointer.getLocalName(node))) { String nodeNS = DOMNodePointer.getNamespaceURI(node); return equalStrings(namespaceURI, nodeNS); } } else if (test instanceof NodeTypeTest) { int nodeType = node.getNodeType(); switch(((NodeTypeTest) test).getNodeType()) { case Compiler.NODE_TYPE_NODE: return nodeType == Node.ELEMENT_NODE; case Compiler.NODE_TYPE_TEXT: return nodeType == Node.CDATA_SECTION_NODE || nodeType == Node.TEXT_NODE; case Compiler.NODE_TYPE_COMMENT: return nodeType == Node.COMMENT_NODE; case Compiler.NODE_TYPE_PI: return nodeType == Node.PROCESSING_INSTRUCTION_NODE; } return false; } else if (test instanceof ProcessingInstructionTest) { if (node.getNodeType() == Node.PROCESSING_INSTRUCTION_NODE) { String testPI = ((ProcessingInstructionTest) test).getTarget(); String nodePI = ((ProcessingInstruction) node).getTarget(); return testPI.equals(nodePI); } } return false; }"
                    ],
                    [
                        0.9800187349319458,
                        "private static NodePointer doStepPredicatesStandard(EvalContext context, NodePointer parent, Step[] steps, int currentStep) { Step step = steps[currentStep]; Expression[] predicates = step.getPredicates(); int axis = step.getAxis(); if (axis == Compiler.AXIS_SELF) { return doPredicate(context, parent, steps, currentStep, predicates, 0); } Expression predicate = predicates[0]; if (predicates.length == 1) { NodeIterator it = getNodeIterator(context, parent, step); NodePointer pointer = null; if (it != null) { if (predicate instanceof NameAttributeTest) { String key = keyFromPredicate(context, predicate); for (int i = 1; it.setPosition(i); i++) { NodePointer ptr = it.getNodePointer(); if (isNameAttributeEqual(ptr, key)) { pointer = ptr; break; } } } else { int index = indexFromPredicate(context, predicate); if (it.setPosition(index + 1)) { pointer = it.getNodePointer(); } } } if (pointer != null) { return doStep(context, pointer, steps, currentStep + 1); } } else { NodeIterator it = getNodeIterator(context, parent, step); if (it != null) { List list = new ArrayList(); for (int i = 1; it.setPosition(i); i++) { list.add(it.getNodePointer()); } NodePointer pointer = doPredicatesStandard(context, list, steps, currentStep, predicates, 0); if (pointer != null) { return pointer; } } } return createNullPointer(context, parent, steps, currentStep); }"
                    ],
                    [
                        0.9798958897590637,
                        "public boolean canConvert(Object object, Class toType) { if (object == null) { return true; } if (toType == Object.class) { return true; } Class fromType = object.getClass(); if (fromType.equals(toType)) { return true; } if (toType.isAssignableFrom(fromType)) { return true; } if (toType == String.class) { return true; } if (object instanceof Boolean) { if (toType == boolean.class || Number.class.isAssignableFrom(toType)) { return true; } } else if (object instanceof Number) { if (toType.isPrimitive() || Number.class.isAssignableFrom(toType)) { return true; } } else if (object instanceof Character) { if (toType == char.class) { return true; } } else if (object instanceof String) { if (toType.isPrimitive()) { return true; } if (toType == Boolean.class || toType == Character.class || toType == Byte.class || toType == Short.class || toType == Integer.class || toType == Long.class || toType == Float.class || toType == Double.class) { return true; } } else if (fromType.isArray()) { if (toType.isArray()) { Class cType = toType.getComponentType(); int length = Array.getLength(object); for (int i = 0; i < length; i++) { Object value = Array.get(object, i); if (!canConvert(value, cType)) { return false; } } return true; } else if (Collection.class.isAssignableFrom(toType)) { return canCreateCollection(toType); } else { if (Array.getLength(object) > 0) { Object value = Array.get(object, 0); return canConvert(value, toType); } else { return canConvert(\\\"\\\", toType); } } } else if (object instanceof Collection) { if (toType.isArray()) { Class cType = toType.getComponentType(); Iterator it = ((Collection) object).iterator(); while (it.hasNext()) { Object value = it.next(); if (!canConvert(value, cType)) { return false; } } return true; } else if (Collection.class.isAssignableFrom(toType)) { return canCreateCollection(toType); } else { if (((Collection) object).size() > 0) { Object value; if (object instanceof List) { value = ((List) object).get(0); } else { Iterator it = ((Collection) object).iterator(); value = it.next(); } return canConvert(value, toType); } else { return canConvert(\\\"\\\", toType); } } } else if (object instanceof NodeSet) { return canConvert(((NodeSet) object).getValues(), toType); } else if (object instanceof Pointer) { return canConvert(((Pointer) object).getValue(), toType); } return ConvertUtils.lookup(toType) != null; }"
                    ],
                    [
                        0.9778993129730225,
                        "public Object convert(Object object, Class toType) { if (object == null) { if (toType.isPrimitive()) { return convertNullToPrimitive(toType); } return null; } if (toType == Object.class) { if (object instanceof NodeSet) { return convert(((NodeSet) object).getValues(), toType); } else if (object instanceof Pointer) { return convert(((Pointer) object).getValue(), toType); } return object; } Class fromType = object.getClass(); if (fromType.equals(toType) || toType.isAssignableFrom(fromType)) { return object; } if (fromType.isArray()) { int length = Array.getLength(object); if (toType.isArray()) { Class cType = toType.getComponentType(); Object array = Array.newInstance(cType, length); for (int i = 0; i < length; i++) { Object value = Array.get(object, i); Array.set(array, i, convert(value, cType)); } return array; } else if (Collection.class.isAssignableFrom(toType)) { Collection collection = allocateCollection(toType); for (int i = 0; i < length; i++) { collection.add(Array.get(object, i)); } return unmodifiableCollection(collection); } else { if (length > 0) { Object value = Array.get(object, 0); return convert(value, toType); } else { return convert(\\\"\\\", toType); } } } else if (object instanceof Collection) { int length = ((Collection) object).size(); if (toType.isArray()) { Class cType = toType.getComponentType(); Object array = Array.newInstance(cType, length); Iterator it = ((Collection) object).iterator(); for (int i = 0; i < length; i++) { Object value = it.next(); Array.set(array, i, convert(value, cType)); } return array; } else if (Collection.class.isAssignableFrom(toType)) { Collection collection = allocateCollection(toType); collection.addAll((Collection) object); return unmodifiableCollection(collection); } else { if (length > 0) { Object value; if (object instanceof List) { value = ((List) object).get(0); } else { Iterator it = ((Collection) object).iterator(); value = it.next(); } return convert(value, toType); } else { return convert(\\\"\\\", toType); } } } else if (object instanceof NodeSet) { return convert(((NodeSet) object).getValues(), toType); } else if (object instanceof Pointer) { return convert(((Pointer) object).getValue(), toType); } else if (toType == String.class) { return object.toString(); } else if (object instanceof Boolean) { if (toType == boolean.class) { return object; } boolean value = ((Boolean) object).booleanValue(); return allocateNumber(toType, value ? 1 : 0); } else if (object instanceof Number) { double value = ((Number) object).doubleValue(); if (toType == boolean.class || toType == Boolean.class) { return value == 0.0 ? Boolean.FALSE : Boolean.TRUE; } if (toType.isPrimitive() || Number.class.isAssignableFrom(toType)) { return allocateNumber(toType, value); } } else if (object instanceof Character) { if (toType == char.class) { return object; } } else if (object instanceof String) { Object value = convertStringToPrimitive(object, toType); if (value != null) { return value; } } Converter converter = ConvertUtils.lookup(toType); if (converter != null) { return converter.convert(toType, object); } throw new JXPathTypeConversionException(\\\"Cannot convert \\\" + object.getClass() + \\\" to \\\" + toType); }"
                    ],
                    [
                        0.9766049981117249,
                        "public String asPath() { if (id != null) { return \\\"id('\\\" + escape(id) + \\\"')\\\"; } StringBuffer buffer = new StringBuffer(); if (parent != null) { buffer.append(parent.asPath()); } if (node instanceof Element) { if (parent instanceof JDOMNodePointer) { if (buffer.length() == 0 || buffer.charAt(buffer.length() - 1) != '/') { buffer.append('/'); } String nsURI = getNamespaceURI(); String ln = JDOMNodePointer.getLocalName(node); if (equalStrings(nsURI, getNamespaceResolver().getDefaultNamespaceURI())) { buffer.append(ln); buffer.append('['); buffer.append(getRelativePositionByName()).append(']'); } else { String prefix = getNamespaceResolver().getPrefix(nsURI); if (prefix != null) { buffer.append(prefix); buffer.append(':'); buffer.append(ln); buffer.append('['); buffer.append(getRelativePositionByName()); buffer.append(']'); } else { buffer.append(\\\"node()\\\"); buffer.append('['); buffer.append(getRelativePositionOfElement()); buffer.append(']'); } } } } else if (node instanceof Text || node instanceof CDATA) { buffer.append(\\\"/text()\\\"); buffer.append('[').append(getRelativePositionOfTextNode()).append(']'); } else if (node instanceof ProcessingInstruction) { String target = ((ProcessingInstruction) node).getTarget(); buffer.append(\\\"/processing-instruction(\\'\\\").append(target).append(\\\"')\\\"); buffer.append('[').append(getRelativePositionOfPI(target)).append(']'); } return buffer.toString(); }"
                    ],
                    [
                        0.9760477542877197,
                        "public Object invoke(ExpressionContext context, Object[] parameters) { try { Object target; Object[] args; if (Modifier.isStatic(method.getModifiers())) { target = null; if (parameters == null) { parameters = EMPTY_ARRAY; } int pi = 0; Class[] types = method.getParameterTypes(); if (types.length >= 1 && ExpressionContext.class.isAssignableFrom(types[0])) { pi = 1; } args = new Object[parameters.length + pi]; if (pi == 1) { args[0] = context; } for (int i = 0; i < parameters.length; i++) { args[i + pi] = TypeUtils.convert(parameters[i], types[i + pi]); } } else { int pi = 0; Class[] types = method.getParameterTypes(); if (types.length >= 1 && ExpressionContext.class.isAssignableFrom(types[0])) { pi = 1; } target = TypeUtils.convert(parameters[0], method.getDeclaringClass()); args = new Object[parameters.length - 1 + pi]; if (pi == 1) { args[0] = context; } for (int i = 1; i < parameters.length; i++) { args[pi + i - 1] = TypeUtils.convert(parameters[i], types[i + pi - 1]); } } return method.invoke(target, args); } catch (Throwable ex) { if (ex instanceof InvocationTargetException) { ex = ((InvocationTargetException) ex).getTargetException(); } throw new JXPathInvalidAccessException(\\\"Cannot invoke \\\" + method, ex); } }"
                    ]
                ],
                "directly_related_tests": [
                    "org.apache.commons.jxpath.ri.model.jdom.JDOMModelTest::testGetNode"
                ],
                "generation": {
                    "1": {
                        "prompt": "You are an expert Java developer. Below is a buggy method from a large Java project. This method causes one or more test failures.\nYour task is to fix the bug in this method. Use the provided test failure(s) to guide your reasoning.\n\n---\n\n## Buggy Method\n\n```java\n\n    public static boolean testNode(\n        NodePointer pointer,\n        Object node,\n        NodeTest test) \n    {\n        if (test == null) {\n            return true;\n        }\n        else if (test instanceof NodeNameTest) {\n            if (!(node instanceof Element)) {\n                return false;\n            }\n\n            NodeNameTest nodeNameTest = (NodeNameTest) test;\n            QName testName = nodeNameTest.getNodeName();\n            String namespaceURI = nodeNameTest.getNamespaceURI();\n            boolean wildcard = nodeNameTest.isWildcard();\n            String testPrefix = testName.getPrefix();\n            if (wildcard && testPrefix == null) {\n                return true;\n            }\n\n            if (wildcard\n                || testName.getName()\n                        .equals(JDOMNodePointer.getLocalName(node))) {\n                String nodeNS = JDOMNodePointer.getNamespaceURI(node);\n                return equalStrings(namespaceURI, nodeNS);\n            }\n\n        }\n        else if (test instanceof NodeTypeTest) {\n            switch (((NodeTypeTest) test).getNodeType()) {\n                case Compiler.NODE_TYPE_NODE :\n                    return node instanceof Element;\n                case Compiler.NODE_TYPE_TEXT :\n                    return (node instanceof Text) || (node instanceof CDATA);\n                case Compiler.NODE_TYPE_COMMENT :\n                    return node instanceof Comment;\n                case Compiler.NODE_TYPE_PI :\n                    return node instanceof ProcessingInstruction;\n            }\n            return false;\n        }\n        else if (test instanceof ProcessingInstructionTest) {\n            if (node instanceof ProcessingInstruction) {\n                String testPI = ((ProcessingInstructionTest) test).getTarget();\n                String nodePI = ((ProcessingInstruction) node).getTarget();\n                return testPI.equals(nodePI);\n            }\n        }\n\n        return false;\n    }\n\n```\n---\n\n## Failing Test Case(s)\n\n \n#Test method 1:\n```java\n    public void testGetNode() {\n        assertXPathNodeType(context, \"/\", Document.class);\n        assertXPathNodeType(context, \"/vendor/location\", Element.class);\n        assertXPathNodeType(context, \"//location/@name\", Attribute.class);\n        assertXPathNodeType(context, \"//vendor\", Element.class); //bugzilla #38586\n    }\n```\n#Error message: java.lang.NullPointerException\n\tat org.apache.commons.jxpath.JXPathTestCase.assertXPathNodeType(JXPathTestCase.java:224)  assertTrue(\"Evaluating <\" + xpath + \"> = \" + actual.getNode().getClass(),                clazz.isAssignableFrom(actual.getNode().getClass()));\n\tat org.apache.commons.jxpath.ri.model.jdom.JDOMModelTest.testGetNode(JDOMModelTest.java:65)  assertXPathNodeType(context, \"//vendor\", Element.class); //bugzilla #38586\n\n---\n\n## Your Goal\n\nFix the buggy method. Return only the fixed Java method. Do not include explanations or other text.\n",
                        "patches": [
                            "\npublic static boolean testNode(\n    NodePointer pointer,\n    Object node,\n    NodeTest test) \n{\n    if (test == null) {\n        return true;\n    }\n    else if (test instanceof NodeNameTest) {\n        if (!(node instanceof Element)) {\n            return false;\n        }\n\n        NodeNameTest nodeNameTest = (NodeNameTest) test;\n        QName testName = nodeNameTest.getNodeName();\n        String namespaceURI = nodeNameTest.getNamespaceURI();\n        boolean wildcard = nodeNameTest.isWildcard();\n        String testPrefix = testName.getPrefix();\n        if (wildcard && testPrefix == null) {\n            return true;\n        }\n\n        if (wildcard\n            || testName.getName()\n                    .equals(JDOMNodePointer.getLocalName(node))) {\n            String nodeNS = JDOMNodePointer.getNamespaceURI(node);\n            return equalStrings(namespaceURI, nodeNS) || namespaceURI == null;\n        }\n\n    }\n    else if (test instanceof NodeTypeTest) {\n        switch (((NodeTypeTest) test).getNodeType()) {\n            case Compiler.NODE_TYPE_NODE :\n                return true; // Fix: return true for any node type\n            case Compiler.NODE_TYPE_TEXT :\n                return (node instanceof Text) || (node instanceof CDATA);\n            case Compiler.NODE_TYPE_COMMENT :\n                return node instanceof Comment;\n            case Compiler.NODE_TYPE_PI :\n                return node instanceof ProcessingInstruction;\n        }\n        return false;\n    }\n    else if (test instanceof ProcessingInstructionTest) {\n        if (node instanceof ProcessingInstruction) {\n            String testPI = ((ProcessingInstructionTest) test).getTarget();\n            String nodePI = ((ProcessingInstruction) node).getTarget();\n            return testPI.equals(nodePI);\n        }\n    }\n\n    return false;\n}\n",
                            "\n    public static boolean testNode(\n        NodePointer pointer,\n        Object node,\n        NodeTest test) \n    {\n        if (test == null) {\n            return true;\n        }\n        else if (test instanceof NodeNameTest) {\n            if (!(node instanceof Element)) {\n                return false;\n            }\n\n            NodeNameTest nodeNameTest = (NodeNameTest) test;\n            QName testName = nodeNameTest.getNodeName();\n            String namespaceURI = nodeNameTest.getNamespaceURI();\n            boolean wildcard = nodeNameTest.isWildcard();\n            String testPrefix = testName.getPrefix();\n            if (wildcard && testPrefix == null) {\n                return true;\n            }\n\n            if (wildcard\n                || testName.getName()\n                        .equals(JDOMNodePointer.getLocalName(node))) {\n                String nodeNS = JDOMNodePointer.getNamespaceURI(node);\n                if (nodeNS == null) {\n                    nodeNS = \"\";\n                }\n                return equalStrings(namespaceURI, nodeNS);\n            }\n\n        }\n        else if (test instanceof NodeTypeTest) {\n            switch (((NodeTypeTest) test).getNodeType()) {\n                case Compiler.NODE_TYPE_NODE :\n                    return node instanceof Element;\n                case Compiler.NODE_TYPE_TEXT :\n                    return (node instanceof Text) || (node instanceof CDATA);\n                case Compiler.NODE_TYPE_COMMENT :\n                    return node instanceof Comment;\n                case Compiler.NODE_TYPE_PI :\n                    return node instanceof ProcessingInstruction;\n            }\n            return false;\n        }\n        else if (test instanceof ProcessingInstructionTest) {\n            if (node instanceof ProcessingInstruction) {\n                String testPI = ((ProcessingInstructionTest) test).getTarget();\n                String nodePI = ((ProcessingInstruction) node).getTarget();\n                return testPI.equals(nodePI);\n            }\n        }\n\n        return false;\n    }\n\n",
                            "\n    public static boolean testNode(\n        NodePointer pointer,\n        Object node,\n        NodeTest test) \n    {\n        if (test == null) {\n            return true;\n        }\n        else if (test instanceof NodeNameTest) {\n            if (!(node instanceof Element)) {\n                return false;\n            }\n\n            NodeNameTest nodeNameTest = (NodeNameTest) test;\n            QName testName = nodeNameTest.getNodeName();\n            String namespaceURI = nodeNameTest.getNamespaceURI();\n            boolean wildcard = nodeNameTest.isWildcard();\n            String testPrefix = testName.getPrefix();\n            if (wildcard && testPrefix == null) {\n                return true;\n            }\n\n            if (wildcard\n                || testName.getName()\n                        .equals(JDOMNodePointer.getLocalName(node))) {\n                String nodeNS = JDOMNodePointer.getNamespaceURI(node);\n                return equalStrings(namespaceURI, nodeNS);\n            }\n\n        }\n        else if (test instanceof NodeTypeTest) {\n            switch (((NodeTypeTest) test).getNodeType()) {\n                case Compiler.NODE_TYPE_NODE :\n                    return node instanceof Element || node instanceof Document;\n                case Compiler.NODE_TYPE_TEXT :\n                    return (node instanceof Text) || (node instanceof CDATA);\n                case Compiler.NODE_TYPE_COMMENT :\n                    return node instanceof Comment;\n                case Compiler.NODE_TYPE_PI :\n                    return node instanceof ProcessingInstruction;\n            }\n            return false;\n        }\n        else if (test instanceof ProcessingInstructionTest) {\n            if (node instanceof ProcessingInstruction) {\n                String testPI = ((ProcessingInstructionTest) test).getTarget();\n                String nodePI = ((ProcessingInstruction) node).getTarget();\n                return testPI.equals(nodePI);\n            }\n        }\n\n        return false;\n    }\n",
                            "\npublic static boolean testNode(\n    NodePointer pointer,\n    Object node,\n    NodeTest test) \n{\n    if (test == null) {\n        return true;\n    }\n    else if (test instanceof NodeNameTest) {\n        if (!(node instanceof Element)) {\n            return false;\n        }\n\n        NodeNameTest nodeNameTest = (NodeNameTest) test;\n        QName testName = nodeNameTest.getNodeName();\n        String namespaceURI = nodeNameTest.getNamespaceURI();\n        boolean wildcard = nodeNameTest.isWildcard();\n        String testPrefix = testName.getPrefix();\n        if (wildcard && testPrefix == null) {\n            return true;\n        }\n\n        if (wildcard\n            || testName.getName()\n                    .equals(JDOMNodePointer.getLocalName(node))) {\n            String nodeNS = JDOMNodePointer.getNamespaceURI(node);\n            return equalStrings(namespaceURI, nodeNS);\n        }\n\n    }\n    else if (test instanceof NodeTypeTest) {\n        switch (((NodeTypeTest) test).getNodeType()) {\n            case Compiler.NODE_TYPE_NODE :\n                return node != null;\n            case Compiler.NODE_TYPE_TEXT :\n                return (node instanceof Text) || (node instanceof CDATA);\n            case Compiler.NODE_TYPE_COMMENT :\n                return node instanceof Comment;\n            case Compiler.NODE_TYPE_PI :\n                return node instanceof ProcessingInstruction;\n        }\n        return false;\n    }\n    else if (test instanceof ProcessingInstructionTest) {\n        if (node instanceof ProcessingInstruction) {\n            String testPI = ((ProcessingInstructionTest) test).getTarget();\n            String nodePI = ((ProcessingInstruction) node).getTarget();\n            return testPI.equals(nodePI);\n        }\n    }\n\n    return false;\n}\n",
                            "\npublic static boolean testNode(\n    NodePointer pointer,\n    Object node,\n    NodeTest test) \n{\n    if (test == null) {\n        return true;\n    }\n    else if (test instanceof NodeNameTest) {\n        if (!(node instanceof Element || node instanceof Attribute)) {\n            return false;\n        }\n    \n        NodeNameTest nodeNameTest = (NodeNameTest) test;\n        QName testName = nodeNameTest.getNodeName();\n        String namespaceURI = nodeNameTest.getNamespaceURI();\n        boolean wildcard = nodeNameTest.isWildcard();\n        String testPrefix = testName.getPrefix();\n        if (wildcard && testPrefix == null) {\n            return true;\n        }\n    \n        if (wildcard\n            || testName.getName()\n                    .equals(JDOMNodePointer.getLocalName(node))) {\n            String nodeNS = JDOMNodePointer.getNamespaceURI(node);\n            return equalStrings(namespaceURI, nodeNS);\n        }\n    \n    }\n    else if (test instanceof NodeTypeTest) {\n        switch (((NodeTypeTest) test).getNodeType()) {\n            case Compiler.NODE_TYPE_NODE :\n                return node instanceof Element || node instanceof Document || node instanceof Attribute;\n            case Compiler.NODE_TYPE_TEXT :\n                return (node instanceof Text) || (node instanceof CDATA);\n            case Compiler.NODE_TYPE_COMMENT :\n                return node instanceof Comment;\n            case Compiler.NODE_TYPE_PI :\n                return node instanceof ProcessingInstruction;\n        }\n        return false;\n    }\n    else if (test instanceof ProcessingInstructionTest) {\n        if (node instanceof ProcessingInstruction) {\n            String testPI = ((ProcessingInstructionTest) test).getTarget();\n            String nodePI = ((ProcessingInstruction) node).getTarget();\n            return testPI.equals(nodePI);\n        }\n    }\n\n    return false;\n}\n",
                            "\npublic static boolean testNode(\n    NodePointer pointer,\n    Object node,\n    NodeTest test) \n{\n    if (test == null) {\n        return true;\n    }\n    else if (test instanceof NodeNameTest) {\n        if (!(node instanceof Element)) {\n            return false;\n        }\n\n        NodeNameTest nodeNameTest = (NodeNameTest) test;\n        QName testName = nodeNameTest.getNodeName();\n        String namespaceURI = nodeNameTest.getNamespaceURI();\n        boolean wildcard = nodeNameTest.isWildcard();\n        String testPrefix = testName.getPrefix();\n        if (wildcard && testPrefix == null) {\n            return true;\n        }\n\n        if (wildcard\n            || testName.getName()\n                    .equals(JDOMNodePointer.getLocalName(node))) {\n            String nodeNS = JDOMNodePointer.getNamespaceURI(node);\n            return equalStrings(namespaceURI, nodeNS);\n        }\n\n    }\n    else if (test instanceof NodeTypeTest) {\n        switch (((NodeTypeTest) test).getNodeType()) {\n            case Compiler.NODE_TYPE_NODE :\n                return true; // Fix: check for any node\n            case Compiler.NODE_TYPE_TEXT :\n                return (node instanceof Text) || (node instanceof CDATA);\n            case Compiler.NODE_TYPE_COMMENT :\n                return node instanceof Comment;\n            case Compiler.NODE_TYPE_PI :\n                return node instanceof ProcessingInstruction;\n        }\n        return false;\n    }\n    else if (test instanceof ProcessingInstructionTest) {\n        if (node instanceof ProcessingInstruction) {\n            String testPI = ((ProcessingInstructionTest) test).getTarget();\n            String nodePI = ((ProcessingInstruction) node).getTarget();\n            return testPI.equals(nodePI);\n        }\n    }\n\n    return false;\n}\n",
                            "\n    public static boolean testNode(\n        NodePointer pointer,\n        Object node,\n        NodeTest test) \n    {\n        if (test == null) {\n            return true;\n        }\n        else if (test instanceof NodeNameTest) {\n            if (!(node instanceof Element)) {\n                return false;\n            }\n\n            NodeNameTest nodeNameTest = (NodeNameTest) test;\n            QName testName = nodeNameTest.getNodeName();\n            String namespaceURI = nodeNameTest.getNamespaceURI();\n            boolean wildcard = nodeNameTest.isWildcard();\n            String testPrefix = testName.getPrefix();\n            if (wildcard && (testPrefix == null || testPrefix.isEmpty())) {\n                return true;\n            }\n\n            if (wildcard\n                || testName.getName()\n                        .equals(JDOMNodePointer.getLocalName(node))) {\n                String nodeNS = JDOMNodePointer.getNamespaceURI(node);\n                return equalStrings(namespaceURI, nodeNS);\n            }\n\n        }\n        else if (test instanceof NodeTypeTest) {\n            switch (((NodeTypeTest) test).getNodeType()) {\n                case Compiler.NODE_TYPE_NODE :\n                    return node instanceof Element || node instanceof Document || node instanceof Attribute;\n                case Compiler.NODE_TYPE_TEXT :\n                    return (node instanceof Text) || (node instanceof CDATA);\n                case Compiler.NODE_TYPE_COMMENT :\n                    return node instanceof Comment;\n                case Compiler.NODE_TYPE_PI :\n                    return node instanceof ProcessingInstruction;\n            }\n            return false;\n        }\n        else if (test instanceof ProcessingInstructionTest) {\n            if (node instanceof ProcessingInstruction) {\n                String testPI = ((ProcessingInstructionTest) test).getTarget();\n                String nodePI = ((ProcessingInstruction) node).getTarget();\n                return testPI.equals(nodePI);\n            }\n        }\n\n        return false;\n    }\n",
                            "\npublic static boolean testNode(\n    NodePointer pointer,\n    Object node,\n    NodeTest test) \n{\n    if (test == null) {\n        return true;\n    }\n    else if (test instanceof NodeNameTest) {\n        if (!(node instanceof Element)) {\n            return false;\n        }\n\n        NodeNameTest nodeNameTest = (NodeNameTest) test;\n        QName testName = nodeNameTest.getNodeName();\n        String namespaceURI = nodeNameTest.getNamespaceURI();\n        boolean wildcard = nodeNameTest.isWildcard();\n        String testPrefix = testName.getPrefix();\n        if (wildcard && (testPrefix == null || testName.getName().equals(\"*\"))) {\n            return true;\n        }\n\n        if (wildcard\n            || testName.getName()\n                    .equals(JDOMNodePointer.getLocalName(node))) {\n            String nodeNS = JDOMNodePointer.getNamespaceURI(node);\n            return equalStrings(namespaceURI, nodeNS);\n        }\n\n    }\n    else if (test instanceof NodeTypeTest) {\n        switch (((NodeTypeTest) test).getNodeType()) {\n            case Compiler.NODE_TYPE_NODE :\n                return true; // Node type node should return true for any node\n            case Compiler.NODE_TYPE_TEXT :\n                return (node instanceof Text) || (node instanceof CDATA);\n            case Compiler.NODE_TYPE_COMMENT :\n                return node instanceof Comment;\n            case Compiler.NODE_TYPE_PI :\n                return node instanceof ProcessingInstruction;\n        }\n        return false;\n    }\n    else if (test instanceof ProcessingInstructionTest) {\n        if (node instanceof ProcessingInstruction) {\n            String testPI = ((ProcessingInstructionTest) test).getTarget();\n            String nodePI = ((ProcessingInstruction) node).getTarget();\n            return testPI.equals(nodePI);\n        }\n    }\n\n    return false;\n}\n",
                            "\n    public static boolean testNode(\n        NodePointer pointer,\n        Object node,\n        NodeTest test) \n    {\n        if (test == null) {\n            return true;\n        }\n        else if (test instanceof NodeNameTest) {\n            if (!(node instanceof Element)) {\n                return false;\n            }\n\n            NodeNameTest nodeNameTest = (NodeNameTest) test;\n            QName testName = nodeNameTest.getNodeName();\n            String namespaceURI = nodeNameTest.getNamespaceURI();\n            boolean wildcard = nodeNameTest.isWildcard();\n            String testPrefix = testName.getPrefix();\n            if (wildcard && testPrefix == null) {\n                return true;\n            }\n\n            if (wildcard\n                || testName.getName()\n                        .equals(JDOMNodePointer.getLocalName(node))) {\n                String nodeNS = JDOMNodePointer.getNamespaceURI(node);\n                return equalStrings(namespaceURI, nodeNS);\n            }\n\n        }\n        else if (test instanceof NodeTypeTest) {\n            switch (((NodeTypeTest) test).getNodeType()) {\n                case Compiler.NODE_TYPE_NODE :\n                    return true; // Treat as a general node test\n                case Compiler.NODE_TYPE_TEXT :\n                    return (node instanceof Text) || (node instanceof CDATA);\n                case Compiler.NODE_TYPE_COMMENT :\n                    return node instanceof Comment;\n                case Compiler.NODE_TYPE_PI :\n                    return node instanceof ProcessingInstruction;\n            }\n            return false;\n        }\n        else if (test instanceof ProcessingInstructionTest) {\n            if (node instanceof ProcessingInstruction) {\n                String testPI = ((ProcessingInstructionTest) test).getTarget();\n                String nodePI = ((ProcessingInstruction) node).getTarget();\n                return testPI.equals(nodePI);\n            }\n        }\n\n        return false;\n    }\n",
                            "\npublic static boolean testNode(\n    NodePointer pointer,\n    Object node,\n    NodeTest test) \n{\n    if (test == null) {\n        return true;\n    }\n    else if (test instanceof NodeNameTest) {\n        if (!(node instanceof Element)) {\n            return false;\n        }\n\n        NodeNameTest nodeNameTest = (NodeNameTest) test;\n        QName testName = nodeNameTest.getNodeName();\n        String namespaceURI = nodeNameTest.getNamespaceURI();\n        boolean wildcard = nodeNameTest.isWildcard();\n        String testPrefix = testName.getPrefix();\n        if (wildcard && testPrefix == null) {\n            return true;\n        }\n\n        if (wildcard\n            || testName.getName()\n                    .equals(JDOMNodePointer.getLocalName(node))) {\n            String nodeNS = JDOMNodePointer.getNamespaceURI(node);\n            return equalStrings(namespaceURI, nodeNS);\n        }\n        \n        return false; // Ensure a boolean is returned if the if conditions above are not met\n    }\n    else if (test instanceof NodeTypeTest) {\n        switch (((NodeTypeTest) test).getNodeType()) {\n            case Compiler.NODE_TYPE_NODE :\n                return node instanceof Element;\n            case Compiler.NODE_TYPE_TEXT :\n                return (node instanceof Text) || (node instanceof CDATA);\n            case Compiler.NODE_TYPE_COMMENT :\n                return node instanceof Comment;\n            case Compiler.NODE_TYPE_PI :\n                return node instanceof ProcessingInstruction;\n        }\n        return false;\n    }\n    else if (test instanceof ProcessingInstructionTest) {\n        if (node instanceof ProcessingInstruction) {\n            String testPI = ((ProcessingInstructionTest) test).getTarget();\n            String nodePI = ((ProcessingInstruction) node).getTarget();\n            return testPI.equals(nodePI);\n        }\n    }\n\n    return false;\n}\n"
                        ],
                        "plausible_patches": [
                            "\npublic static boolean testNode(\n    NodePointer pointer,\n    Object node,\n    NodeTest test) \n{\n    if (test == null) {\n        return true;\n    }\n    else if (test instanceof NodeNameTest) {\n        if (!(node instanceof Element)) {\n            return false;\n        }\n\n        NodeNameTest nodeNameTest = (NodeNameTest) test;\n        QName testName = nodeNameTest.getNodeName();\n        String namespaceURI = nodeNameTest.getNamespaceURI();\n        boolean wildcard = nodeNameTest.isWildcard();\n        String testPrefix = testName.getPrefix();\n        if (wildcard && testPrefix == null) {\n            return true;\n        }\n\n        if (wildcard\n            || testName.getName()\n                    .equals(JDOMNodePointer.getLocalName(node))) {\n            String nodeNS = JDOMNodePointer.getNamespaceURI(node);\n            return equalStrings(namespaceURI, nodeNS) || namespaceURI == null;\n        }\n\n    }\n    else if (test instanceof NodeTypeTest) {\n        switch (((NodeTypeTest) test).getNodeType()) {\n            case Compiler.NODE_TYPE_NODE :\n                return true; // Fix: return true for any node type\n            case Compiler.NODE_TYPE_TEXT :\n                return (node instanceof Text) || (node instanceof CDATA);\n            case Compiler.NODE_TYPE_COMMENT :\n                return node instanceof Comment;\n            case Compiler.NODE_TYPE_PI :\n                return node instanceof ProcessingInstruction;\n        }\n        return false;\n    }\n    else if (test instanceof ProcessingInstructionTest) {\n        if (node instanceof ProcessingInstruction) {\n            String testPI = ((ProcessingInstructionTest) test).getTarget();\n            String nodePI = ((ProcessingInstruction) node).getTarget();\n            return testPI.equals(nodePI);\n        }\n    }\n\n    return false;\n}\n",
                            "\n    public static boolean testNode(\n        NodePointer pointer,\n        Object node,\n        NodeTest test) \n    {\n        if (test == null) {\n            return true;\n        }\n        else if (test instanceof NodeNameTest) {\n            if (!(node instanceof Element)) {\n                return false;\n            }\n\n            NodeNameTest nodeNameTest = (NodeNameTest) test;\n            QName testName = nodeNameTest.getNodeName();\n            String namespaceURI = nodeNameTest.getNamespaceURI();\n            boolean wildcard = nodeNameTest.isWildcard();\n            String testPrefix = testName.getPrefix();\n            if (wildcard && testPrefix == null) {\n                return true;\n            }\n\n            if (wildcard\n                || testName.getName()\n                        .equals(JDOMNodePointer.getLocalName(node))) {\n                String nodeNS = JDOMNodePointer.getNamespaceURI(node);\n                return equalStrings(namespaceURI, nodeNS);\n            }\n\n        }\n        else if (test instanceof NodeTypeTest) {\n            switch (((NodeTypeTest) test).getNodeType()) {\n                case Compiler.NODE_TYPE_NODE :\n                    return node instanceof Element || node instanceof Document;\n                case Compiler.NODE_TYPE_TEXT :\n                    return (node instanceof Text) || (node instanceof CDATA);\n                case Compiler.NODE_TYPE_COMMENT :\n                    return node instanceof Comment;\n                case Compiler.NODE_TYPE_PI :\n                    return node instanceof ProcessingInstruction;\n            }\n            return false;\n        }\n        else if (test instanceof ProcessingInstructionTest) {\n            if (node instanceof ProcessingInstruction) {\n                String testPI = ((ProcessingInstructionTest) test).getTarget();\n                String nodePI = ((ProcessingInstruction) node).getTarget();\n                return testPI.equals(nodePI);\n            }\n        }\n\n        return false;\n    }\n",
                            "\npublic static boolean testNode(\n    NodePointer pointer,\n    Object node,\n    NodeTest test) \n{\n    if (test == null) {\n        return true;\n    }\n    else if (test instanceof NodeNameTest) {\n        if (!(node instanceof Element)) {\n            return false;\n        }\n\n        NodeNameTest nodeNameTest = (NodeNameTest) test;\n        QName testName = nodeNameTest.getNodeName();\n        String namespaceURI = nodeNameTest.getNamespaceURI();\n        boolean wildcard = nodeNameTest.isWildcard();\n        String testPrefix = testName.getPrefix();\n        if (wildcard && testPrefix == null) {\n            return true;\n        }\n\n        if (wildcard\n            || testName.getName()\n                    .equals(JDOMNodePointer.getLocalName(node))) {\n            String nodeNS = JDOMNodePointer.getNamespaceURI(node);\n            return equalStrings(namespaceURI, nodeNS);\n        }\n\n    }\n    else if (test instanceof NodeTypeTest) {\n        switch (((NodeTypeTest) test).getNodeType()) {\n            case Compiler.NODE_TYPE_NODE :\n                return node != null;\n            case Compiler.NODE_TYPE_TEXT :\n                return (node instanceof Text) || (node instanceof CDATA);\n            case Compiler.NODE_TYPE_COMMENT :\n                return node instanceof Comment;\n            case Compiler.NODE_TYPE_PI :\n                return node instanceof ProcessingInstruction;\n        }\n        return false;\n    }\n    else if (test instanceof ProcessingInstructionTest) {\n        if (node instanceof ProcessingInstruction) {\n            String testPI = ((ProcessingInstructionTest) test).getTarget();\n            String nodePI = ((ProcessingInstruction) node).getTarget();\n            return testPI.equals(nodePI);\n        }\n    }\n\n    return false;\n}\n",
                            "\npublic static boolean testNode(\n    NodePointer pointer,\n    Object node,\n    NodeTest test) \n{\n    if (test == null) {\n        return true;\n    }\n    else if (test instanceof NodeNameTest) {\n        if (!(node instanceof Element || node instanceof Attribute)) {\n            return false;\n        }\n    \n        NodeNameTest nodeNameTest = (NodeNameTest) test;\n        QName testName = nodeNameTest.getNodeName();\n        String namespaceURI = nodeNameTest.getNamespaceURI();\n        boolean wildcard = nodeNameTest.isWildcard();\n        String testPrefix = testName.getPrefix();\n        if (wildcard && testPrefix == null) {\n            return true;\n        }\n    \n        if (wildcard\n            || testName.getName()\n                    .equals(JDOMNodePointer.getLocalName(node))) {\n            String nodeNS = JDOMNodePointer.getNamespaceURI(node);\n            return equalStrings(namespaceURI, nodeNS);\n        }\n    \n    }\n    else if (test instanceof NodeTypeTest) {\n        switch (((NodeTypeTest) test).getNodeType()) {\n            case Compiler.NODE_TYPE_NODE :\n                return node instanceof Element || node instanceof Document || node instanceof Attribute;\n            case Compiler.NODE_TYPE_TEXT :\n                return (node instanceof Text) || (node instanceof CDATA);\n            case Compiler.NODE_TYPE_COMMENT :\n                return node instanceof Comment;\n            case Compiler.NODE_TYPE_PI :\n                return node instanceof ProcessingInstruction;\n        }\n        return false;\n    }\n    else if (test instanceof ProcessingInstructionTest) {\n        if (node instanceof ProcessingInstruction) {\n            String testPI = ((ProcessingInstructionTest) test).getTarget();\n            String nodePI = ((ProcessingInstruction) node).getTarget();\n            return testPI.equals(nodePI);\n        }\n    }\n\n    return false;\n}\n",
                            "\npublic static boolean testNode(\n    NodePointer pointer,\n    Object node,\n    NodeTest test) \n{\n    if (test == null) {\n        return true;\n    }\n    else if (test instanceof NodeNameTest) {\n        if (!(node instanceof Element)) {\n            return false;\n        }\n\n        NodeNameTest nodeNameTest = (NodeNameTest) test;\n        QName testName = nodeNameTest.getNodeName();\n        String namespaceURI = nodeNameTest.getNamespaceURI();\n        boolean wildcard = nodeNameTest.isWildcard();\n        String testPrefix = testName.getPrefix();\n        if (wildcard && testPrefix == null) {\n            return true;\n        }\n\n        if (wildcard\n            || testName.getName()\n                    .equals(JDOMNodePointer.getLocalName(node))) {\n            String nodeNS = JDOMNodePointer.getNamespaceURI(node);\n            return equalStrings(namespaceURI, nodeNS);\n        }\n\n    }\n    else if (test instanceof NodeTypeTest) {\n        switch (((NodeTypeTest) test).getNodeType()) {\n            case Compiler.NODE_TYPE_NODE :\n                return true; // Fix: check for any node\n            case Compiler.NODE_TYPE_TEXT :\n                return (node instanceof Text) || (node instanceof CDATA);\n            case Compiler.NODE_TYPE_COMMENT :\n                return node instanceof Comment;\n            case Compiler.NODE_TYPE_PI :\n                return node instanceof ProcessingInstruction;\n        }\n        return false;\n    }\n    else if (test instanceof ProcessingInstructionTest) {\n        if (node instanceof ProcessingInstruction) {\n            String testPI = ((ProcessingInstructionTest) test).getTarget();\n            String nodePI = ((ProcessingInstruction) node).getTarget();\n            return testPI.equals(nodePI);\n        }\n    }\n\n    return false;\n}\n",
                            "\n    public static boolean testNode(\n        NodePointer pointer,\n        Object node,\n        NodeTest test) \n    {\n        if (test == null) {\n            return true;\n        }\n        else if (test instanceof NodeNameTest) {\n            if (!(node instanceof Element)) {\n                return false;\n            }\n\n            NodeNameTest nodeNameTest = (NodeNameTest) test;\n            QName testName = nodeNameTest.getNodeName();\n            String namespaceURI = nodeNameTest.getNamespaceURI();\n            boolean wildcard = nodeNameTest.isWildcard();\n            String testPrefix = testName.getPrefix();\n            if (wildcard && (testPrefix == null || testPrefix.isEmpty())) {\n                return true;\n            }\n\n            if (wildcard\n                || testName.getName()\n                        .equals(JDOMNodePointer.getLocalName(node))) {\n                String nodeNS = JDOMNodePointer.getNamespaceURI(node);\n                return equalStrings(namespaceURI, nodeNS);\n            }\n\n        }\n        else if (test instanceof NodeTypeTest) {\n            switch (((NodeTypeTest) test).getNodeType()) {\n                case Compiler.NODE_TYPE_NODE :\n                    return node instanceof Element || node instanceof Document || node instanceof Attribute;\n                case Compiler.NODE_TYPE_TEXT :\n                    return (node instanceof Text) || (node instanceof CDATA);\n                case Compiler.NODE_TYPE_COMMENT :\n                    return node instanceof Comment;\n                case Compiler.NODE_TYPE_PI :\n                    return node instanceof ProcessingInstruction;\n            }\n            return false;\n        }\n        else if (test instanceof ProcessingInstructionTest) {\n            if (node instanceof ProcessingInstruction) {\n                String testPI = ((ProcessingInstructionTest) test).getTarget();\n                String nodePI = ((ProcessingInstruction) node).getTarget();\n                return testPI.equals(nodePI);\n            }\n        }\n\n        return false;\n    }\n",
                            "\npublic static boolean testNode(\n    NodePointer pointer,\n    Object node,\n    NodeTest test) \n{\n    if (test == null) {\n        return true;\n    }\n    else if (test instanceof NodeNameTest) {\n        if (!(node instanceof Element)) {\n            return false;\n        }\n\n        NodeNameTest nodeNameTest = (NodeNameTest) test;\n        QName testName = nodeNameTest.getNodeName();\n        String namespaceURI = nodeNameTest.getNamespaceURI();\n        boolean wildcard = nodeNameTest.isWildcard();\n        String testPrefix = testName.getPrefix();\n        if (wildcard && (testPrefix == null || testName.getName().equals(\"*\"))) {\n            return true;\n        }\n\n        if (wildcard\n            || testName.getName()\n                    .equals(JDOMNodePointer.getLocalName(node))) {\n            String nodeNS = JDOMNodePointer.getNamespaceURI(node);\n            return equalStrings(namespaceURI, nodeNS);\n        }\n\n    }\n    else if (test instanceof NodeTypeTest) {\n        switch (((NodeTypeTest) test).getNodeType()) {\n            case Compiler.NODE_TYPE_NODE :\n                return true; // Node type node should return true for any node\n            case Compiler.NODE_TYPE_TEXT :\n                return (node instanceof Text) || (node instanceof CDATA);\n            case Compiler.NODE_TYPE_COMMENT :\n                return node instanceof Comment;\n            case Compiler.NODE_TYPE_PI :\n                return node instanceof ProcessingInstruction;\n        }\n        return false;\n    }\n    else if (test instanceof ProcessingInstructionTest) {\n        if (node instanceof ProcessingInstruction) {\n            String testPI = ((ProcessingInstructionTest) test).getTarget();\n            String nodePI = ((ProcessingInstruction) node).getTarget();\n            return testPI.equals(nodePI);\n        }\n    }\n\n    return false;\n}\n"
                        ]
                    }
                }
            }
        ],
        "trigger_test": {
            "org.apache.commons.jxpath.ri.model.dom.DOMModelTest::testGetNode": {
                "path": "src/test/org/apache/commons/jxpath/ri/model/dom/DOMModelTest.java",
                "function_name": "testGetNode",
                "src": "    public void testGetNode() {\n        assertXPathNodeType(context, \"/\", Document.class);\n        assertXPathNodeType(context, \"/vendor/location\", Element.class);\n        assertXPathNodeType(context, \"//location/@name\", Attr.class);\n        assertXPathNodeType(context, \"//vendor\", Element.class);\n    }",
                "error_msg": "java.lang.NullPointerException\n\tat org.apache.commons.jxpath.JXPathTestCase.assertXPathNodeType(JXPathTestCase.java:224)\n\tat org.apache.commons.jxpath.ri.model.dom.DOMModelTest.testGetNode(DOMModelTest.java:68)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat junit.framework.TestCase.runTest(TestCase.java:176)\n\tat junit.framework.TestCase.runBare(TestCase.java:141)\n\tat junit.framework.TestResult$1.protect(TestResult.java:122)\n\tat junit.framework.TestResult.runProtected(TestResult.java:142)\n\tat junit.framework.TestResult.run(TestResult.java:125)\n\tat junit.framework.TestCase.run(TestCase.java:129)\n\tat junit.framework.TestSuite.runTest(TestSuite.java:255)\n\tat junit.framework.TestSuite.run(TestSuite.java:250)\n\tat org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.java:520)\n\tat org.apache.tools.ant.taskdefs.optional.junit.JUnitTask.executeInVM(JUnitTask.java:1484)\n\tat org.apache.tools.ant.taskdefs.optional.junit.JUnitTask.execute(JUnitTask.java:872)\n\tat org.apache.tools.ant.taskdefs.optional.junit.JUnitTask.executeOrQueue(JUnitTask.java:1972)\n\tat org.apache.tools.ant.taskdefs.optional.junit.JUnitTask.execute1(JUnitTask.java:824)\n\tat org.apache.tools.ant.taskdefs.optional.junit.JUnitTask.execute(JUnitTask.java:2277)\n\tat org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)\n\tat sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)\n\tat org.apache.tools.ant.Task.perform(Task.java:348)\n\tat org.apache.tools.ant.Target.execute(Target.java:392)\n\tat org.apache.tools.ant.Target.performTasks(Target.java:413)\n\tat org.apache.tools.ant.Project.executeSortedTargets(Project.java:1399)\n\tat org.apache.tools.ant.Project.executeTarget(Project.java:1368)\n\tat org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)\n\tat org.apache.tools.ant.Project.executeTargets(Project.java:1251)\n\tat org.apache.tools.ant.Main.runBuild(Main.java:811)\n\tat org.apache.tools.ant.Main.startAnt(Main.java:217)\n\tat org.apache.tools.ant.launch.Launcher.run(Launcher.java:280)\n\tat org.apache.tools.ant.launch.Launcher.main(Launcher.java:109)",
                "clean_error_msg": "java.lang.NullPointerException\n\tat org.apache.commons.jxpath.JXPathTestCase.assertXPathNodeType(JXPathTestCase.java:224)  assertTrue(\"Evaluating <\" + xpath + \"> = \" + actual.getNode().getClass(),                clazz.isAssignableFrom(actual.getNode().getClass()));\n\tat org.apache.commons.jxpath.ri.model.dom.DOMModelTest.testGetNode(DOMModelTest.java:68)  assertXPathNodeType(context, \"//vendor\", Element.class);"
            },
            "org.apache.commons.jxpath.ri.model.jdom.JDOMModelTest::testGetNode": {
                "path": "src/test/org/apache/commons/jxpath/ri/model/jdom/JDOMModelTest.java",
                "function_name": "testGetNode",
                "src": "    public void testGetNode() {\n        assertXPathNodeType(context, \"/\", Document.class);\n        assertXPathNodeType(context, \"/vendor/location\", Element.class);\n        assertXPathNodeType(context, \"//location/@name\", Attribute.class);\n        assertXPathNodeType(context, \"//vendor\", Element.class); //bugzilla #38586\n    }",
                "error_msg": "java.lang.NullPointerException\n\tat org.apache.commons.jxpath.JXPathTestCase.assertXPathNodeType(JXPathTestCase.java:224)\n\tat org.apache.commons.jxpath.ri.model.jdom.JDOMModelTest.testGetNode(JDOMModelTest.java:65)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat junit.framework.TestCase.runTest(TestCase.java:176)\n\tat junit.framework.TestCase.runBare(TestCase.java:141)\n\tat junit.framework.TestResult$1.protect(TestResult.java:122)\n\tat junit.framework.TestResult.runProtected(TestResult.java:142)\n\tat junit.framework.TestResult.run(TestResult.java:125)\n\tat junit.framework.TestCase.run(TestCase.java:129)\n\tat junit.framework.TestSuite.runTest(TestSuite.java:255)\n\tat junit.framework.TestSuite.run(TestSuite.java:250)\n\tat org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.java:520)\n\tat org.apache.tools.ant.taskdefs.optional.junit.JUnitTask.executeInVM(JUnitTask.java:1484)\n\tat org.apache.tools.ant.taskdefs.optional.junit.JUnitTask.execute(JUnitTask.java:872)\n\tat org.apache.tools.ant.taskdefs.optional.junit.JUnitTask.executeOrQueue(JUnitTask.java:1972)\n\tat org.apache.tools.ant.taskdefs.optional.junit.JUnitTask.execute1(JUnitTask.java:824)\n\tat org.apache.tools.ant.taskdefs.optional.junit.JUnitTask.execute(JUnitTask.java:2277)\n\tat org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)\n\tat sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)\n\tat org.apache.tools.ant.Task.perform(Task.java:348)\n\tat org.apache.tools.ant.Target.execute(Target.java:392)\n\tat org.apache.tools.ant.Target.performTasks(Target.java:413)\n\tat org.apache.tools.ant.Project.executeSortedTargets(Project.java:1399)\n\tat org.apache.tools.ant.Project.executeTarget(Project.java:1368)\n\tat org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)\n\tat org.apache.tools.ant.Project.executeTargets(Project.java:1251)\n\tat org.apache.tools.ant.Main.runBuild(Main.java:811)\n\tat org.apache.tools.ant.Main.startAnt(Main.java:217)\n\tat org.apache.tools.ant.launch.Launcher.run(Launcher.java:280)\n\tat org.apache.tools.ant.launch.Launcher.main(Launcher.java:109)",
                "clean_error_msg": "java.lang.NullPointerException\n\tat org.apache.commons.jxpath.JXPathTestCase.assertXPathNodeType(JXPathTestCase.java:224)  assertTrue(\"Evaluating <\" + xpath + \"> = \" + actual.getNode().getClass(),                clazz.isAssignableFrom(actual.getNode().getClass()));\n\tat org.apache.commons.jxpath.ri.model.jdom.JDOMModelTest.testGetNode(JDOMModelTest.java:65)  assertXPathNodeType(context, \"//vendor\", Element.class); //bugzilla #38586"
            }
        },
        "evaluation_done": true
    }
}